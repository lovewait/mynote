## 计算机系统结构,要求达到"识记"层次
### 层次结构
计算机系统是由硬件和软件组成的一种层次式的结构.最内层是硬件系统,最外层是使用计算机系统的人,人与硬件系统之间是软件系统.
硬件系统主要由中央处理器、存储器、输入/输出控制系统和各种输入/输出设备组成.中央处理器是对信息进行高速运算和处理的部件.存储器可分为主存储器和辅助存储器,用于存放各种程序和数据.主存储器可被中央处理器直接访问.输入/输出设备是计算机与用户间的交互接口部件.输入/输出控制系统管理外围设备与主存储器之间的信息传递.
软件系统包括系统软件、支撑软件和应用软件三部分.
系统软件是计算机系统中与硬件结合最机密的软件,也是计算机系统中必不可少的软件.
支撑软件是可支持其他软件的开发和维护的软件.
### 系统工作框架
当接通计算机电源或重新启动系统时,计算机系统立即自动执行引导程序.引导程序首先进行系统初始化的工作,然后把操作系统中的核心程序装入主存储器,并当操作系统的核心程序占用处理器执行.
操作系统核心程序完成自身的初始化工作后便等待用户从键盘或输入命令.每接收一条命令后就对该命令进行处理.一条命令处理结束后,操作系统再等待下一条命令.
操作系统对每次接收的命令进行分析和处理,并按命令的要求分别调出编译程序、数据库程序或各种应用程序等来执行.当这些程序执行时,操作系统总是静静地等待某个事件的发生.
对可能出现的各种不同类型的事件都有操作系统的各种服务程序去处理它.
## 硬件环境,要求达到"领会"层次
### CPU与外设的并行工作
计算机系统中,都是通过输入/输出控制系统完成外围设备与主存储器之间的信息传送.各种外围设备连接在相应的设备控制器上.这些设备控制器又通过通道连接在公共的系统总线上.这种结构允许中央处理器和各种外围设备同时并行工作,它们都能访问共享的主存储器.
中央处理按程序规定的顺序执行指令.当执行到一条启动外设的指令时,就按指令中给定的参数启动指定的设备,并把控制移交给输入/输出控制系统,由输入输出控制系统控制外围设备与主存储器之间的信息传送,外围设备独立工作,不再需要中央处理器干预,于是中央处理器可继续执行其他程序.
### I/O中断的作用
中央处理器和外设并行工作时,由于外围设备是由中央处理器根据程序要求而启动的,故当外围设备工作结束后,应反馈该设备的工作情况.这种反馈可通过中断完成.
### 处理器中的寄存器
寄存器是处理器的组成部分,用来存放处理器的工作信息.
分类:
1. 通用寄存器.存放参加运算的操作数、指令的运算结果等
2. 指令寄存器.存放当前从主存储器读出的指令
3. 控制寄存器.存放控制信息以保证程序的正确执行和系统的安全.
    控制寄存器包括:
    1. 程序状态字寄存器
    2. 中断字寄存器
    3. 基址寄存器
    4. 限长寄存器
### 主存储器、高速缓冲存储器、辅助存储器
#### 主存储器
在计算机系统中,任何程序和数据都必须在装入主存储器之后才能对其进行操作,主存储器以"字节"为单位进行编址.若干个字节可组成一个"字".处理器可以按地址读出主存储器中一个字节或一个字的内容.读出的内容可以存放到寄存器中,也可以把寄存器中的内容存储到指定地址的主存储器单元中.
主存储器容量较大,能被处理器直接访问.所以,经常要把当前要执行的程序和数据驻留在主存储器中.由于主存储器不是一种永久性的存储设备,当店员被切断时主存储器中的信息就会消失,因而,需要长期保存的信息不能存放在主存储器中.
#### 高速缓冲存储器
当程序和数据被装入主存储器后,处理器在执行程序时就要不断地访问主存储器,从中读出指令和操作数,然后对操作数进行处理,处理的结果又会被保存到主存储器中.通常,处理器执行程序时花在访问主存储器的时间远远大于处理数据的时间.
为了减少对主存储器的访问时间,加快程序的执行速度,现代计算机系统往往配置一个高速缓冲存储器.高速缓冲存储器的存取速度大大快于主存储器的存取速度,但其价格昂贵.所以,在计算机系统中配置的高速缓冲存储器的容量一般较小.
处理器对cache的存取速度快于主存储器,cache的存储容量小于主存储器而大于寄存器.于是,位于处理器和主存储器之间的cache起到了缩短存取时间和缓冲存储的作用,故称其为高速缓冲存储器.
#### 辅助存储器
磁盘和磁带是最常用的辅助存储器.辅助存储器的优点是容量大且能永久的保存信息,但它们不能被中央处理器直接访问.
辅助存储器只能与主存储器相互传送信息.要把主存储器中的信息存储到磁盘或磁带上,必须启动相应的磁盘机或磁带机.同样,要把磁盘或磁带上的信息读到主存储器,也必须启动相应的设备.所以,若处理器要用的信息在辅助存储器中,则先要启动设备把信息传送到主存储器,再把信息从主存储器读到寄存器才能处理,需花费较长的时间.
### 特权指令,管态/目态,存储保护
#### 特权指令
为了保证计算机系统能正确可靠地工作,硬件把由中央处理器执行的指令分为两类:特权指令和非特权指令.不允许用户程序中直接使用的指令称为特权指令,其余称为非特权指令.
特权指令只允许操作系统程序使用,用户程序不得使用特权指令.这是因为,若允许用户程序直接使用特权指令,则可能会造成错误.
由操作系统启动外围设备不仅可保证安全地使用外围设备,正确地传送信息,而且可以减少用户为启动外围设备而必须了解外围设备特性及组织启动等工作,大大方便了用户
其他一些特权指令也都是对计算机系统中的资源进行控制和管理的指令.由于计算机系统中的资源是由操作系统统一管理的,因而不允许用户程序使用这些指令.
#### 管态和目态
我们规定用户程序中不允许使用特权指令,但为了解决用户程序中出现特权指令的问题,设置了中央处理器的两种工作状态:管态和目态.当中央处理器处于管态时可执行包括特权指令在内的一切机器指令,当中央处理器处于目态时不允许执行特权指令.所以,操作系统程序占用中央处理器时,应让中央处理器在管态下工作,而用户程序占用中央处理器时,应让中央处理器在目态下工作.当中央处理器在目态下工作时,若取得了一条特权指令,此时中央处理器将拒绝执行该指令,并形成一个"非法操作"时间.硬件识别到该事件后,便暂停当前程序的执行,且把事件转交给操作系统去处理,由操作系统通知用户:"程序有非法指令",必须修改
#### 存储保护
主存储器中往往同时装入了操作系统和若干用户程序.为了保证正确地操作,我们希望操作系统程序不被破坏,也希望用户程序相互间不干扰.这就必须限定用户程序只能在规定的主存区域内执行,以保护各程序的安全.主存储器有多种管理方式.不同的管理方式有不同的实现保护的方法.若关系式:
基址寄存器的值<= 访问地址 <= 基址寄存器的值+限长寄存器的值
则允许访问,否则不允许访问.
## 操作系统结构,要求达到"识记"层次
### 设计目标
1. 正确性.能引起操作系统工作不正确的因素很多,其中最主要的用户作业的类型以及作业达到系统的时间是随意的,系统中的各种事件是随机的,多个随机达到的作业都要占用中央处理器和使用计算机系统的其他资源.操作系统必须充分估计和把握各种不确定的情况.一个结构良好的操作系统不仅能保证正确性,而且易于验证其正确性.
2. 高效性.操作系统自身的开销,减少操作系统的开销就能提高计算机系统的效率,尤其对常驻主存储器的核心程序部分更要精心设计.核心程序处于频繁活动状态,是影响计算机系统效率的关键所在.核心程序应遵循少而精的原则,是处理既有效又灵活.
3. 维护性.一个操作系统交付使用后,有时会对其功能进行一些增删;当发现错误时还需要进行修改;为了提高效率,也会对算法进行调整等.因此在结构设计时,应注意到这些问题,使操作系统容易维护.
4. 移植性.所谓移植性,是指能否方便的把操作系统从一个硬件环境移植到另一个新的硬件环境中.为了能方便地移植,在结构设计时,应尽量减少与硬件直接有关的程序量,且将其独立封装.这样,在移植时只要修改这一部分程序即可.如果能采用国际通用的标准C语言或C++语言编写操作系统,那么,只要经过重新编译和设置必要的参数,就可使其适应新的硬件环境.

### 操作系统的层次结构
操作系统结构的设计方便有无序模块法、内核扩充法、层次结构法、管程设计法等.层次结构法的最大特点是把整个问题局部化.一个大型复杂的操作系统被分解成若干单向依赖的层次,由各层的正确性来保证整个系统的正确性.采用层次结构不仅结构清晰,而且便于调试,有利于功能的增加、删减和修改
从资源管理的观点看,操作系统的功能分四部分,即处理器管理、存储管理、文件管理和设备管理.这四大部分相互配合,协调工作,实现对计算机系统的资源管理和控制程序的执行,为用户提供方便的使用接口和良好的运行环境.
层次结构的主要优点是有利于系统的设计和调试.实现各层次的功能时都可利用较内层提供的功能,不必知道内层的功能是怎样实现的,只需知道这些功能可做什么.调试工作可从最内层开始,最内层只使用硬件提供的功能,调试时无需考虑其他任何部分.一旦最内层调试通过,则第二层可在最内层提供的功能上执行.同样,调试第三层时可在第二层提供的功能上执行,依次类推,知道完成各层功能的调试.若在调试某层的功能时发现错误,可断定错误位于当前层,因为较内层的各层次已通过调试.
层次结构的主要困难在于层次的划分和安排.由于每一层只能利用位于它内层提供的功能,因而需要仔细的规划每一层的功能,以保证操作系统工作过程中不出现双向依赖关系.
### UNIX系统的结构
UNIX是一个交互的分时操作系统.从结构上看,UNIX可以分成内核层和外壳层两部分.
内核层是UNIX操作系统的核心.它具有存储管理、文件管理、设备管理、进程管理等功能,以及为外壳层提供服务的系统调用.外壳层为用户提供各种操作命令和程序设计环境.外壳层由shell解释程序、支持程序设计的各种语言、编译系统、解释程序、使用程序和系统库等组成.
## 操作系统与用户的接口,要求达到"领会"层次
### 操作控制命令
一个用户作业进入计算机系统后,除程序执行时要调用系统功能外,用户往往还要告诉操作系统控制作业执行的步骤,为此,操作系统提供了让联机用户表示作业执行步骤的手段:操作控制命令.
用户可以从键盘输入操作控制命令,或从菜单中选择命令,来指出作业的执行步骤.当使用操作控制命令时,用户每输入一条命令,操作系统就按命令要求控制程序的执行.一条命令的控制结束后,就通知用户输入下一条命令,直至作业执行结束.
### 系统调用
操作系统编制了许多不同功能的子程序,供用户程序执行中调用,这些由操作系统提供的子程序程序称为系统功能调用程序,简称系统调用.
系统调用时操作系统为用户程序提供的一种服务界面,或者说,是操作系统保证程序设计语言能正常工作的一种支持.在源程序一级,用户用程序设计语言描述算题任务的逻辑要求,这些要求的实现只有通过操作系统的系统调用才能完成,其中有些要求还必须执行硬件的特权指令才能达到目的.所以,系统调用应是在管态下执行的程序.
不同的操作系统提供的系统调用不全相同.大致上可分为如下几类:
1. 文件操作类.
2. 资源申请类
3. 控制类
4. 信息维护类
## UNIX的用户接口,要求达到"领会"层次
### UNIX的shell命令
UNIX提供的操作控制命令称为shell命令,一组shell命令组成了shell命令语言.
UNIX是一个多用户的分时操作系统.每个用户在使用shell命令前必须先在系统中注册登录,以便系统识别和区分使用系统的每个用户,并且能保证每个用户的程序和数据不被其他用户破坏.
1. 注册和注销
2. 常用的shell命令.mkdir、rmdir、cd、pwd、ls、cp、mv、rm、cat、more等
3. 后台执行的shell命令
4. shell文件

### UNIX的系统调用
1. 常用的系统调用.分为三类:文件操作类、控制类、信号与时间类
2. trap指令.在UNIX中,规定用户程序用trap指令来请求系统调用.
3. 系统调用程序入口表
4. 系统调用实现过程