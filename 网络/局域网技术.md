## 介质访问控制子层
### 信道访问权的分配:静态分配,动态分配
1. 静态分配策略
> 静态分配策略包括频分多路复用和同步时分多路复用,这种分配策略是预先将频带或时隙固定地分配给各个网络节点,各节点都有自己专用的频带或时隙,彼此之间不会产生干扰.静态分配策略适用于网络节点数目少而固定,且每个节点都有大量数据要发送的场合.此时采用静态分配策略不仅控制协议简单,而且信道利用率较高.

2. 动态分配策略
> 动态分配策略包括随机访问和控制访问,本质上属于异步时分多路复用.各站点当有数据需要发送时,才占用信道进行数据传输.
随机访问又称争用,各个网络节点在发送前不需要申请信道的使用权,有数据就发送,发生碰撞之后再采取措施解决.随机访问适用于负载较轻的网络,其信道利用率一般不高,但网络延迟时间较短.

### 局域网的介质访问控制协议:争用协议,无冲突协议,有限争用协议
#### 争用协议
> 最早采用争用协议的计算机网络是20世纪70年代美国夏威夷大学的Norman Abramson设计的ALOHA系统
ALOHA系统有两种版本:纯ALOHA和时分ALOHA.两者区别在于是否将时间分为离散的时隙.纯ALOHA系统中时间是连续的,不需要全局时间同步;而时分ALOHA系统中时间是离散的,必须进行时间同步.
1. 纯ALOHA.纯ALOHA系统的基本思想是:任何用户有数据需要发送就可以发送;用户通过监听信道来获得是否产生冲突、数据传输是否成功;若发现有冲突发生导致数据传输失败,在等待一段随机时间后,再重新发送.
> 因为用户在发送数据前不需要取得信道的使用权,有数据就可以发送,所以存在产生冲突而导致数据帧被破坏的可能性.但是,由于广播的反馈性,发送方只需要监听信道就可以得知它发出的帧是否被破坏.对于局域网,反馈信息很快就可以得到,对于卫星网,发送方在延迟270ms后才可以确认发送成功与否.如果监听到冲突,发送方等待一段随机时间后重发该帧.等待时间必须是随机的,否则有可能因为连续的冲突而导致系统死锁.
需要说明的是,任何时候,只要由两个网络节点同时使用信道发送数据就会产生冲突,并破坏所发送数据帧的内容.即使两个数据帧只有一个二进制位相重叠,两帧也会发生破坏,都必须重发.
研究发现,采用定长帧的ALOHA系统可以获得最大的吞吐量.引入帧的概念来表示发送一个标准长度的帧所需要的时间.

在ALOHA系统中,一方面不断有新产生的数据帧发送;另一方面由于冲突的发生,那些被破坏的数据帧也需要重发.为了分析ALOHA系统的性能,引入两个归一化参数:
    1. 吞吐量S:又称吞吐率,指在单位帧时内系统成功发送新产生的数据帧的平均数量.显然有0<=S<=1.S=1是最好的情况,此时帧一个接一个地发送出去,帧与帧之间没有空隙,信道利用最为充分.但在各系统用户无序争用、帧随机产生的情况下这个极值是不可能达到的.但是可以利用S接近1的程度来衡量信道的利用率是否充分.
    2. 网络负载G:指在单位帧时内系统发送的所有数据帧的平均数量,包括成功发送的帧和因冲突而重发的帧.显然有G>=S.只有在不发生冲突的情况下,才有G=S.当系统的负载很小时,几乎不发生冲突,这时可以认为S=G.当系统负载增大而有冲突发生时,显然有G>S.
    对于一个实际运行的系统.在稳定状态下,吞吐量S和网络负载G的关系为:
    $S=GP$
    其中P为系统中一个帧成功发送的概率,实际上就是发送成功的帧在所有发送成功的帧总数中所占的比例.
    经过数学公式推导(过程略),在纯ALOHA系统中,2t时间内只有一个数据帧的概率,即帧成功发送的概率为:
    $P=e^{-2G}$
    因此系统的吞吐量:
    $S=Ge^{-2G}$
    当G为0.5时,$S_{max}=1/(2e)\approx0.184$.也就是说,纯ALOHA系统信道利用率的理论最大值只有18.4%.实际应用中为了安全起见,纯ALOHA系统的吞吐量S一般不超过10%.尽管如此,在很多情况下,当需要进行突发式的交换性数据通信时,纯ALOHA系统依然是一种既简单又经济的通信方式.

2. 时分ALOHA.针对纯ALOHA系统信道利用率低下的问题,Roberts于1972年提出一种对纯ALOHA系统的改进方法:时分ALOHA系统.
时分ALOHA系统的基本思想是:将时间分成等长的间隙,每个间隙可以用来发送一个帧;用户有数据帧要发送时,不论帧在何时发生,都必须到下一个时隙开始时才能发送;用户通过监听信道来获知是否产生冲突、数据传输是否成功;若发现有冲突发生导致数据传输失败,则在随机等待若干个时隙后,再重新发送.
> 时分ALOHA系统必须具有某种同步机制,以保证每个网络节点都确切知道每个间隙的开始.通常的实现方法是设置一个特殊的网络节点在每个时隙的开始发送一个信号.
每个帧在到达后,一般都要在缓冲区中等待一段时间(等待时间小于时隙$T_0$),然后才能发送出去.当在一个时隙内有两个或两个以上的帧到达时,则在下一个时隙将产生冲突.冲突后对重发策略与纯ALOHA系统的情况是相似的,但随机等待的时间长度为时隙的整数倍.

在时分ALOHA系统中限制每个用户只能在时隙的开始发送数据,这样,连续的纯ALOHA就变成了离散的时分ALOHA.由于发生碰撞的可能性减小了一半,时分ALOHA系统的易破坏长度缩小为1.
同样经过数学公式推导,在时分ALOHA系统中,t时间内只有一个数据帧的概率,即帧成功发送的概率:
$P=e^{-G}$
当G=1时,$S_{max}=1/e\approx0.368$.也就是说,时分ALOHA系统信道利用率的理论最大值为36.8%.
3. 载波监听多路访问(CSMA)协议.尽管时分ALOHA系统的效率是纯ALOHA系统的两倍,但仍然是比较低的,因为每个网络节点都是随心所欲的发送数据,即使别的站正在发送也照发不误,因此发生碰撞的概率很大.CSMA协议是在ALOHA协议的基础上提出的一种改进协议,与ALOHA协议的主要区别就是多了一个载波监听装置.
> 在采用CSMA协议的网络系统中,每个节点在发送数据前先监听信道是否有载波存在(即是否有数据在传输),再根据监听的结果决定如何动作.由于采用了附加的硬件装置,每个网络节点都可以在发送数据前监听信道上是否有其它节点在发送数据,若有,则该节点就暂不发送数据,这就减少了发送冲突的可能,从而提高了系统的吞吐量.

根据监听方式以及监听到信道忙后的反应方式的不同,有多种不同的CSMA协议,下面介绍其中的4种:
1. 1-坚持CSMA.1-坚持CSMA的基本思想是:当一个节点要发送数据时,首先监听信道;如果信道为空闲就发送数据;如果信道忙则等待,同时继续监听直至信道空闲;如果发生冲突,则随机等待一段时间后,再重新开始监听信道
>"1-坚持"的含义是只当监听到信道忙后,继续坚持监听信道;当监听到信道空闲后,其发送数据的概率为1,即立即发送数据.
信号传输延迟对1-坚持CSMA协议的性能影响很大.概率虽小但仍然可能出现这样一种情况,当节点A开始发送数据时,节点B也正好有数据要发送,但这时节点A发出的数据传输信号还未到达节点B,节点B监听信道,发现信道空闲,于是立即发送数据,结果必然导致冲突.信号传输延迟越大,这种情况发生的可能性越大,协议的性能就越差.即使不考虑传输延迟,1-坚持CSMA协议也可能产生延迟.
尽管也存在冲突的可能,1-坚持CSMA协议的性能要好于ALOHA系统,因为有节点在发送数据时,其他节点检测到信道忙后就不会再发送数据了.

2. 非坚持CSMA.非坚持CSMA的基本思想是:当一个节点要发送数据时,首先监听信道;如果信道空闲就立即发送数据;如果信道忙则放弃监听、随机等待一段时间,再开始监听信道.
> 与1-坚持CSMA的"贪婪"不同,非坚持CSMA比较"理智",在监听到信道忙后将放弃监听,这样就减少了多个节点等待信道空闲后同时发送数据导致冲突的概率.因为个节点在监听到信道忙时,都放弃监听,各自随机等待一段时间后再监听,这就有可能将各节点重新试图发送数据的时间错开,避免了冲突的发生.
但与此同时,非坚持CSMA也使得数据在网络中的平均延迟时间增加了.因为当某个节点发完数据后,由于非坚持的随机等待,其他节点没有连续监听信道,也就不可能紧接着立即发送,造成数据在网络中的平均延迟时间的增加.可见,信道利用率的提高是以数据在网络中的延迟时间增加为代价的.

3. p-坚持CSMA.p-坚持CSMA(p-persistent CSMA)用于时分信道(Slotted channel),其基本思想是,当一个节点要发送数据时,首先监听信道;如果信道忙则坚持监听到下一个时隙;如果信道空闲,便以概率p发送数据,以概率1-p推迟到下一个时隙;如果下一个时隙信道仍然空闲,则仍以概率p发送数据,以概率1-p推迟到下一个时隙;这样过程一直坚持下去,直到数据被发送出去,或因为其他节点发送而检测到信道忙为止,若是后者,则等待一段随机的时间后重新开始监听.
> P-坚持CSMA在检测到信道空闲后,以概率p发送数据,以概率1-p推迟到下一个时隙,其目的是试图降低1-坚持CSMA协议中多个节点检测到信道空闲后同时发送的冲突概率;采用"坚持"监听,是试图克服非坚持CSMA协议中由于随机等待造成延迟时间较长的缺点.
p-坚持CSMA的性能依赖于概率p的选取.假设任一时刻平均有N个节点准备好要发送，则在当前数据发送完后的下一个时隙里,平均有Np个节点要发送数据.如果p选择得过大,使Np>1,则冲突的概率很大,所以应使Np<1;但如果p选择得过小,数据在网络中的延迟时间将变得很长,会降低信道的利用率;一般P的选取应令Np略小于1.
概率p可以用随机发生器产生,假设该随机数发生器产生(0,1)之间的一个随机数r,当r在(0,p)范围内时,发送数据;当r在[p,1]范围内时,推迟到下一个时隙发送

4. 带有冲突检测的CSMA.带有冲突检测的CSMA(CSMA with Collision Detection,CSMA/CD)广泛应用与局域网的MAC子层中,其基本思想是:当一个节点要发送数据时,首先监听信道;如果信道空闲就发送数据,并继续监听;如果在数据发送过程中监听到了冲突,则立刻停止数据发送,等待一段随机时间后,重新开始尝试发送数据.
> CSMA只在发送前监听信道,以保证信道忙时不会有新的节点发送数据;但在数据发送过程中检测到冲突时,仍要将剩余的数据发送完,既浪费时间又浪费带宽.CSMA/CD对此进行改进就是网络节点边发送边监听,一旦监听到冲突就立刻停止发送.这样信道很快就会空闲下来,提高了信道利用率.
CSMA/CD的工作过程:在时刻$Tt_0$一个节点完成数据发送,信道变为空闲,此时其它节点有数据要发送的话都可以发送;当多个节点同时发送时产生冲突,各节点检测到冲突后立即停止发送,于是形成了一个较短的时隙,这种时隙称为争用时隙;各节点停止发送后,各自随机等待一段时间再监听信道,发现信道空闲又发送数据;当争用信道的节点比较多时,可能会接连发送冲突,结果形成一系列的争用时隙,经过几轮竞争后,有一个节点发送数据获得成功;随后,有数据要发送的节点又开始新一轮的争用.因此,CSMA/CD的工作过程就是传输周期、争用周期和空闲周期周而复始,交替出现的一个过程.
冲突检测的方法很多,通常以硬件技术实现.最简单的方法是比较接收到的信号的电压大小.在基带传输过程中,当两个帧的信号叠加在信道上时,电压的摆动值要比正常值大一倍.因此只要接收到的信号的电压摆动值超过某一门限值,就可以认为发生了冲突.当若两个节点距离很远,一直信号在信道上传输时衰减了很多,则有可能使冲突叠加信号的电压摆动值不超过门限值,这就无法判断是否出现了冲突.因此,采用这种基于模拟技术的冲突检测方法,对站间最大距离有一定的限制.另一种可行的方法是在发送帧的同时进行接收,将收到的信号逐比特地与发送的信号相比较,如果有不符合的,就说明出现了冲突.

CSMA/CD中,在每个节点发送数据刚刚开始的一个很短的时间内,由于电磁波在网络上传播需要时间,因此冲突仍有可能发生.那么一个节点在开始发送后,经过多长时间的监听才能确信数据传输成功(仅指不发生冲突)呢?考虑最为极端的一种情况.A和B是网络中相距最远的两个节点,信号从A到B的传输时间为$\tau$.假设在$t_0$时刻A开始发送数据,而恰好在$t_0+\tau-\epsilon$($\epsilon$为一个任意小的整数)时刻B准备好发送数据.B监听信道,发现信道空闲(由于传播时延,A发出的数据尚未到达B),于是立即发送数据,冲突就在B的附近发生了.B立即就检测到了冲突,但A这时还一无所知,只有当被损坏的信号再经过时间$\tau$传到A时,A才知道发生了冲突,所以A检测到冲突的时刻是$t_0+2\tau-\epsilon$.由于$\epsilon$是一个任意小的正数,因此可以说A在开始发送后最多经过$2\tau$时间才能检测到冲突.不失一般性,可将争用时隙的长度确定为网络中最大传输延迟的2倍,即节点在开始发送后,最多经过$2\tau$时间就能确定此次传输是否成功.这个时间通常被作为一个时隙时间.设网络中两个节点间的最大间距为S,信号在物理层的处理延迟为$t_{PHY}$,考虑到发送,接收均经过物理层的处理,则有:
$Slot Time \approx 2S/0.7C + 2t_{PHY}$
其中C为光速,0.7C是电信号在介质上的传播速率.
时隙时间决定了在网络中传输的数据帧的最小帧长$L_{min}$,因为要想在时隙时间内检测到碰撞,就有:
$Slot Time = L_{min}/R$
因此,数据帧的最小帧长:
$L_{min} = Slot Time * R \approx (2S/0.7C + 2t_{PHY}) * R$
因为光速C和物理延迟$t_{PHY}$均为常数,因此公式中的3个参数$L_{min}$、S和R有正、反比关系.当传输速率R固定时,最小帧长$L_{min}$与网络跨距S成正比;而当最小帧长$L_{min}$不变时,传输速率R越高,则网络跨距S越小.这个结论对于今后网络性能的讨论具有指导性意义.
和CSMA一样,CSMA/CD也可以划分为时分和非时分的,而这两种中的每一种又可再分为非坚持,p-坚持和1-坚持这3种.在实际的网络中为方便起见采用非时分的(因为时分系统要进行很复杂的全网时间同步),3种"坚持"各有优点.非坚持不能充分利用信道刚刚转入空闲期的这段时间.1-坚持又容易在上述时间产生冲突.p-坚持可以在一定程度上客服这些缺点,但却很难选择一个能用于各种通信强度的p值.在实用网络中常选择1-坚持.1-坚持比p-坚持在实现上要简单一些.
由于单向传输的原因,对于宽带总线而言,冲突检测时间等于任意两个站之间最大传输时延的4倍.所以,对于宽带CSMA/CD来说,要求数据帧的传输时延至少4倍于传输时延.
在CSMA/CD算法中,一旦检测到冲突并发完阻塞信号后,为了降低再次发生冲突的概率,需要等待一个随机时间,然后再使用CSMA方法试图传输.为了保证这种退避操作维持稳定,采用了一种称为二进制指数退避的算法,其规则如下:
1. 对每个数据帧,当第一次发生冲突时,设置一个参数L=2
2. 退避间隔取1到L个时间片中的一个随机数,1个时间片等于两站点之间的最大传播时延的两倍
3. 当数据帧再次发生冲突,则将参量L加倍
4. 设置一个最大重传次数,超过该次数,则不再重传,并报告出错.
二进制指数退避算法是按后进先出LIFO的次序控制的,即未发生冲突或很少发生冲突的数据帧,具有优先发送的概率;而发生过多次冲突的数据帧,发送成功的概率就更小.
IEEE802.3就是采用二进制指数退避和1-坚持算法的CSMA/CD介质访问控制方法.这种方法在低负荷时,要发送数据帧的站点能立即发送;在重负荷时,仍能保证系统的稳定性.由于在介质上传播的信号会衰减,为确保能检测出冲突信号,CSMA/CD总线网限制一段无分支电缆的最大长度为500米
#### 无冲突协议
在争用协议中由于冲突的存在,影响了系统的性能.无冲突地解决信道争用问题的协议称无冲突协议
1. 位图协议.假设网络中有N个节点,每个节点都拥有一个唯一的序号(0-N-1).位图协议的基本思想是:将数据传输过程分成一系列的预约周期和传输周期;每个预约周期有N个争用时隙组成,每个时隙对应一个节点,节点i可以在时隙i发出一个比特"1"来声明它有一个数据帧要发送,一次预约对信道的使用权;预约周期过后,每个节点都知道了究竟哪些节点要发送数据,接下来进入传输周期,各预约信道的节点按照序号大小顺序一次发送数据;待最后一个节点结束数据发送后,开始新一轮预约.由于预约周期的N个争用时隙就像是N个比特的位图,因此协议被称为位图协议.如果某个节点在其争用时隙过后才做好发送准备,那它必须保持沉默,直到新一轮预约周期自己的争用时隙到来.这种在实际发送之前首先声明的协议又被称为预定协议.
假设每个数据帧由d个时间单位组成.在系统负载较重的情况下,每个节点都有数据要发送,那么N个争用时隙的预约周期后,每个节点轮流发送一个数据帧,共N个帧,平均起来每帧产生了一个时隙的额外开销.因此协议的效率为d/(d+1)
位图协议在较轻负载时是不公平的,而且节点必须等待预约周期结束后才能传输数据,增加了数据的等待时间.为此提出一种改进的位图协议,原有的位图协议又被称为基本位图协议.改进的位图协议有一点变化:节点在自己的争用时隙声明预约后立即开始发送数据,发送之后是协议节点的争用时隙.
改进的位图协议在系统负载较轻的情况下每个节点的平均等待时间都为0.5N个时隙,性能优于基本位图协议;但在负载较重的情况下,二者相差无几.
2. 二进制倒计数协议.二进制倒计数协议的基本思想是:每个节点的地址用二进制数来表示,并假设所有地址长度相等;想要发送的数据的节点,首先将其地址以二进制位串的形式按照从高到低的次序进行广播;所有广播出来的地址要进行对应二进制位的逻辑或运算;节点在发送地址的同时监听信道,当发现自己的地址中的某个"0"在发送出去后变为"1"时,就退出信道的争用;最后参与争用的节点获得信道的使用权发送一个数据帧;数据发送结束后,开始新一轮争用.
如果系统中有N个节点,则地址长度为$log_2N,每个帧为获得信道而增加的额外开销为$Log_2N.如果数据帧长为d,则二进制倒计数协议的信道速率为$d/(d+log_2N)$.但是,如果数据帧格式选择适当,帧中第一个字段就是发送方地址的话,协议效率将达到100%.
显然二进制倒计数协议对不同地址的节点是不公平的,高地址节点优先级高,低地址节点优先级低.为此提出一种改进方案:使用虚拟地址且地址可变,当节点成功发送出一个数据帧后将其地址变为0,使之排在最后,原来排在其后的节点地址递增1,形成优先级轮换.改进方案使长时间保持沉默的节点获得较高的优先权.
#### 3. 有限争用协议
每种信道分配策略的性能都可以根据两项指标加以评定:轻负载下的时间延迟以及重负载下的信道利用率.争用协议和无冲突协议在这两方面各有利弊.系统负载较轻时,争用协议由于其时延短而性能较优.但随着系统负载增加,信道分配的开销越来越大,争用协议的性能也就越来越差.无冲突协议恰好相反,系统负载较轻时,其时延较长,但随着系统负载的增加,信道利用率不仅没有下降,反而有所改善.
> 有限争用协议就是综合争用协议和无冲突协议的有点而产生的一种新的协议,该协议在轻负载时采用争用协议的信道分配策略,使时间延迟较短,而在重负载时采用无冲突协议的信道分配策略,使信道利用率较高.

有限争用信道协议的基本思想是:将系统中的网络节点分组,每个争用时隙只允许一个分组争用信道.协议的关键是如何分配时隙,只要节点分组合理,就可以减少在每个时隙内的竞争,从而提高争用的成功率.分组有两种极端的情况:第一种情况是每组只有一个成员,这样每个时隙最多只有一个站点参与竞争,此时是无冲突协议;第二种情况是所有节点在一个组中,这样每个时隙都是有所有节点参与竞争,此时是争用协议.有限争用协议就是要根据当前网络的分组情况,对节点进行动态分组,当网络分组较轻时,每组的节点数量就多一些,当网络分组较重时,每组的节点数量就少一些.
显然,系统负载越重,搜索开始的层次就应该月底.一般而言,如果当前有q个节点准备发送数据,则应该从第$Log_2^q$层开始搜索

## IEEE802标准与局域网
### IEEE802标准系列
IEEE802参考模型包括了OSI/RM最低两层(物理层和链路层)的功能,也包括网间互连的高层功能和管理功能.OSI/RM的数据链路层功能,在局域网参考模型中被分成介质访问控制MAC和逻辑链路控制LLC两个子层
在ISO/RM中,物理层、数据链路层和网络层使计算机网络具有报文分组转接的功能,对于局域网来说,物理层是必须的,它负责体现机械、电气和过程方面的特性,以建立、维持和拆除物理链路;数据链路层也是必须的,它负责把不可靠的传输信道转换成可靠的传输信道,传送带有校验的数据帧,采用差错控制和帧确认技术.
但是,局域网中的多个设备一般共享公共传输介质,在设备之间传输数据时,首先要解决由哪些设备占有介质的问题,所以局域网的数据链路层必须设置介质访问控制功能.由于局域网采用的介质有多种,对应的介质访问控制方法也有多种,为了使数据帧的传送独立于所采用的物理介质和介质访问控制方法,IEEE802标准特意把LLC独立出来形成一个单独子层,使LLC子层与介质无关,仅让MAC子层依赖于物理介质.由于设立了MAC子层,IEEE802标准就具有了可扩充性,有利于接纳新的介质访问控制方法.
目前主要的IEEE802标准包括:
IEEE802.1是局域网的体系结构、网络管理和网际互连协议.IEEE802.2集中了数据链路层中与介质无关的LLC协议.涉及与介质访问有关的协议,则根据具体网络的介质访问控制方法分别处理,其中主要的MAC协议有:IEEE802.3载波监听多路访问/冲突检测CSMA/CD访问方法和物理层协议、IEEE802.4令牌总线(Token Bus)访问方法和物理层协议、IEEE802.5令牌环(Token Ring)访问方法和物理层协议,IEEE802.6关于城域网的分布式队列双总线DQDB(Distributed Queue Dual Bus)的标准等.
### 局域网的参考模型
在参考模型中,每个实体和另一个系统的同等实体按协议进行通信;而一个系统中上下层之间的通信,则通过接口进行,并用服务访问点SAP来定义接口.为了对多个高层实体提供支持,在LLC层的顶部有多个LLC服务访问点(LSAP),为实体提供接口端;在往基层的顶部有多个网间服务访问点(NSAP),为实体提供接口端;介质访问控制服务访问点(MSAP)向LLC实体提供单个接口端,物理服务访问点(PSAP)也向MAC实体提供单个接口端.
LLC子层中规定了无确认无连接、有确认无连接和面向连接三种类型的链路服务.无确认无连接服务时一种数据报服务,信息帧在LLC实体间交换时,无须在同等实体间事先建立逻辑链路,对这种LLC帧既不确认,也无任何流量控制或差错恢复;有确认无连接服务除了对LLC帧进行确认外,其它类似于无确认无连接服务;面向连接的服务提供服务访问点之间的虚电路服务,在任何信息帧交换前,一对LLC实体之间必须建立逻辑链路,在数据传送过程中,信息帧依此发送,并提供差错回复和流量控制功能.
MAC子层在支持LLC子层完成介质访问控制功能时,可以提供多个可供选择的介质访问控制方式.使用MSAP支持LLC子层时,MAC子层实现帧的寻址和识别.MAC到MAC的操作通过同等层协议来进行,MAC还产生帧校验序列和完成帧检验等功能.
将数据链路层分成两个子层,只要设计合理,使得MAC向上提供统一的服务接口,就能将底层的实现细节完全屏蔽掉,局域网对于LLC子层来说是透明的,只有到MAC子层才能看到所连接的是采用什么标准的局域网.也就是说,对于不同的物理网络,其LLC子层是相同的,数据帧的传送完全独立于所采用的物理介质和介质的访问控制方法,网络层以上的协议可以运行于任何一种IEEE802标准的局域网上.这种分层方法使得IEEE802标准具有良好的可扩充性,可以很方便的接纳新的介质以及介质控制方法.
### IEEE802.2逻辑链路控制子层
局域网的底层只提供尽力的数据报业务,不保证数据的可靠传输,尽管这对有些系统来说已经足够了,但仍有系统希望底层网络能提供更好的服务.为此,IEEE802委员会定义了运行在介质访问控制(MAC)子层智商的逻辑链路控制(LLC)子层
LLC子层负责处理诸如差错控制、流量控制等问题,保证数据的可靠传输:同时向上提供统一的数据链路层接口,从而屏蔽各种物理网络的实现细节.LLC可提供3种服务:不确认的无连接服务、确认的无连接服务和确认的面向连接的服务
不确定的无连接服务:在数据传输前双方不需要建立连接,接收方收到数据后也不要求进行应答,因而链路层不保证数据的正确传送.这种服务形式可用于如下场合:物理网络可靠性极高,不需要在链路层上专门进行差错控制;网络层本身提供不确认无连接服务,因而对链路层提供的服务要求不高;某些实时通信系统允许数据单元的偶然丢失.但要求数据及时传递.
确认的无连接服务:在数据传输前双方不需要建立连接,但接收方对接收到的每一帧数据都要给出应答,因而链路层保证数据的正确传送.这种服务形式可用于如下场合:每次发送的数据量少,不值得专门为此建立连接,但要求数据可靠传送;有些实时系统要求迅速可靠的传输数据,来不及预先建立连接;在广播网络中不需要建立连接,但要求数据可靠传输.
确认的面向连接服务:在数据传输前双方需建立连接,接收方必须对收到的帧进行检错、排序和应答,发送方对出错的帧要进行重发,因而链路层保证全部数据正确有序的传送.这种服务形式可用于如下场合:物理网络可靠性差,在链路层上提供较好的服务可以减轻网络层的负担;需要进行长数据交换,在链路层上保证各个帧正确有序地传送可以减轻较高层上组装的难点和工作量.
### IEEE802.3:协议
IEEE802.3是为采用二进制指数退避和1-坚持CSMA/CD协议的基带总线局域网制定的标准.在低负荷时,要发送的数据帧的站点能立即发送;在重负荷时,仍能保证系统的稳定性.
世界上第一个CSMA/CD局域网是采用无源总线电缆作为传输介质,被称为以太网.并成为IEEE802标准系列中第一个局域网标准.
以太网所采用的介质访问控制方法就是后来成为IEEE802.3标准的载波监听多路访问/冲突检测(CSMA/CD),所以IEEE802.3标准与以太网标准有很多相似之处.但正式发布的IEEE802.3标准和以太网标准并不完全相同,因此把"以太网"同"IEEE802.3局域网"或"CSMA/CD"等同起来不太严格,不过在不涉及网络协议细节时,也把IEEE802.3局域网简称为以太网.
#### CSMA/CD总线的实现模型
IEEE802.3是一个使用CSMA/CD介质访问控制方法的局域网标准.CSMA/CD总线模型对应于ISO/RM的最低两层.从逻辑上可以将其划分为两大部分:一部分由LLC子层组成,实现OSI/RM的数据链路层功能;另一部分实现物理层功能.
把依赖于介质的特性从物理层中分离出来的目的,是要使得LLC子层和MAC子层能适用于各类不同的介质.
物理层内定义了两个兼容的接口:依赖于介质的相关接口MDI和访问单位接口AUI.MDI是一个同轴电缆接口,所有站点都必须遵循IEEE802.3定义的物理介质信号的技术规范,与这个物理介质接口完全兼容.由于大多站点都设在离电缆连接出有一段距离的地方,在与电缆靠近的MAC中只有少量电路,而大部分硬件和全部的软件都在站点中,AUI的存在为MAC和站点的配合使用带来了极大的灵活性.
MAC子层和LLC子层之间的接口提供每个操作的状态信息,以供高一层差错恢复规程所用.MAC子层和物理层之间的接口,提供包括成帧、载波监听、启动传输和解决争用、在两层间传送串行比特流的设施及用于定时等待等的功能.
#### IEEE802.3帧格式
MAC帧是在MAC子层实体间交换的协议数据单位,IEEE802.3MAC帧的格式如图:
| 7       | 1   | 2或6 | 2或6 | 2   | 0~1500 | 0~46 | 4   | 字节 |
| ------- | --- | ---- | ---- | --- | ------ | ---- | --- | ---- |
| 前导码P | SFD | DA   | SA   | LEN | 数据   | PAD  | FCS | -    |
SFD:帧起始定界符
DA: 目的地址
SA: 源地址
LEN:LLC帧长度字段
PAD:填充字符
FCS:帧校验序列
IEEE802.3 MAC帧中包括前导码P、帧其实定界符SFD、目的地址DA、源地址SA、表示数据字段字节数长度的字段LEN、要发送的数据字段、填充字段PAD和帧校验序列FCS等8个字段.这8个字段中除了数据字段和填充字段外,其余的长度都是固定的.
前导码P占7个字节,每个字节的比特模式为"10101010",用于实现收发双方的时钟同步.帧起始定界符字段SFD占一个字节,其比特模式为"10101011",它紧跟在前导码后,用于指示一帧的开始.前导码的作用是使接收端能根据"1"、"0"交变的比特模式迅速实现比特同步,当检测到连续两位"1"(即读到帧起始字段SFD最末两位)时,使将后续的信息递交交给MAC子层.
地址字段包括目的地址字段DA和源地址字段SA.目的地址字段占2个或6个字节,用于标识接收站点的地址,它可以是单个地址,也可以是组地址或广播地址.DA字段最高位"0"表示单个地址,该地址指定网络上某个特定站点;DA字段最高位为"1",其余位不为全"1"表示组地址,该地址指定网络上给定的多个站点;DA字段为全"1",则表示广播地址,该地址指定网络上所有的站点.源地址字段也占2个或6个字节,但其长度必须与目的地址字段的长度相同,它用于标识发送站点的地址.在5字节地址字段中,可以利用其48位中的次高位来区分是局部地址还是全局地址.局部地址是由网络管理员分配,且只有本网中有效的地址;全局地址则是由IEEE统一分配,采用全局地址的网卡出厂时被赋予唯一的IEEE地址,使用这种网卡的站点也就具有了全球独一无二的物理地址.
长度字段LEN占两个字节,其值表示数据字段的字节数长度.数据字段的内容即为LLC子层递交的LLC帧序列,其长度为0~1500字节.
为使CSMA/CD协议正常操作,需要维持一个最短帧长度,必要时可在数据字段之后、帧校验序列FCS之间字节为单位添加填充字符.这是因为正在发送时产生冲突而中断的帧都是很短的帧,为了能方便区分出这些无效帧,IEEE802.3规定了合法的MAC帧的最短帧长.对于10Mbps的基带CSMA/CD网,MAC帧的总长度为64~1518字节.由于除了数据字段和填充字段外,其余字段的总长度为18个字节,所以当数据长度为0是,填充字段必须有46个字节.
帧校验序列FCS字段是32位(即4个字节)的循环冗余码(CRC),其校验范围不包括前导码字段P及帧起始定界符字段SFD.
#### IEEE802.3MAC功能
IEEE802.3标准提供了MAC子层的功能说明,内容主要有数据封装和介质访问管理两个方面.
数据封装(发送和接收数据封装)包括成帧(帧定界和帧同步),编址(源地址及目的地址的处理)和差错检测(物理介质传输差错的检测)等;介质访问管理包括介质分配和竞争处理.
当LLC子层请求发送一数据帧时,MAC子层的发送数据封装部分便按MAC子层的数据帧格式组帧.首先将一个前导码P和一个帧起始定界符SFD附加到帧的开头部分,填上目的地址和源地址,计算出LLC数据帧的字节数,填入数据长度计数字段LEN.必要时还要将填充字符PAD附加到LLC数据帧后,以确保传送阵的长度满足最短帧长的要求.最后求出CRC校验码附加到帧校验序列FCS中.完成数据封装后的MAC帧,便可递交MAC子层的发送介质访问管理部分以供发送.
借助于监视物理层收发信号(PLS)部分提供的载波监听信号,发送介质访问管理设法避免发送信号与介质上其他信号发生冲突.在介质空闲时,经短暂的帧间延迟(提供给介质恢复时间)之后,就启动帧发送.然后,MAC子层将串行位流送给PLS接口以供发送.PLS完成产生介质上电信号的任务,同时监视介质和产生冲突检测信号.在没有争用的情况下,即可完成发送.发送完成后,MAC子层通过LLC与MAC间的接口通知LLC子层,等待下一个发送请求.加入产生冲突,PLS接通冲突检测信号,接着发送介质访问管理开始处理冲突.首先,它发送一串称为阻塞码的位序列来强制冲突,由此保证有足够的冲突持续时间,以使其它与冲突有关的发送站点都得到通知.在阻塞信号结束时,发送介质访问管理就暂停发送,等待一个随机选择的时间间隔后再进行重发尝试.发送介质访问管理用二进制退避算法调整介质负载.最后,或者重发成功,或者在介质故障,过载的情况下,放弃重发尝试.
接收介质访问管理部分的功能是,首先由PLS检测到达帧,使接收始终与前导码同步,并接通载波监听信号.接收介质访问管理部件要检测到达的帧是否错误,帧长是否超过最大长度,是否是8位的整数倍.还要过滤因冲突产生的碎片信号(即小于最短长度的帧).
接收数据解封部分的功能,用于检测帧的目的地址字段,以确定本站点是否应该接收该帧.如地址符合,将其送到LLC层,并进行差错检测.
#### IEEE802.3物理层规范
IEEE802.3为了区分各种可选用的实现方案,给出了一种简明的表示方法:
<数据传输速率(Mbps)><信号方式><最大段长度(百米)>
如:10BASE-T,其中T表示双绞线,如果是F表示光纤.
1. 10BASE5和10BASE2.与10BASE5一样,10BASE2也是用$50\Omega$同轴电缆和曼彻斯特编码,数据速率为10Mbps.两者的区别在于10BASE5是用粗缆($\Phi$10mm),10Base2使用细缆($\Phi5mm$).由于两者数据速率相同,所以可以使10BASE5电缆端和10BASE2电缆段共存于一个网络中.
IEEE802.3的10Mbps可选方案:
| -        | 10BASE5      | 10BASE2      | 10BASE-T     | 10BROAD36    | 10BASE - F   |
| -------- | ------------ | ------------ | ------------ | ------------ | ------------ |
| 传输介质     | 基带同轴电缆       | 基带同轴电缆       | 非屏蔽双绞线       | 宽带同轴电缆       | 850mm光纤对     |
| 编码技术     | 曼彻斯特编码       | 曼彻斯特编码       | 曼彻斯特编码       | 差分PSK码       | 曼彻斯特编码       |
| 拓扑结构     | 总线           | 总线           | 星形           | 总线/树形        | 星形           |
| 最大段长     | 500m         | 185m         | 100m         | 1800m        | 500m         |
| 每段节点     | 100          | 30           | -            | -            | 33           |
2. 10BASE-T.10BASE-T定义了一个物理上的星形拓扑网.其中央节点是一个集线器,每个节点通过一对双绞线与集线器相连.集线器的作用类似于一个转发器,它接收来自一条线上的信号并向其它的所有线转发.由于任意一个站点发出的信号都能被其它所有站点接收,若有两个站点同时要求传输,冲突就必然发生.所以,尽管这种策略在物理上是一个星形结构,但从逻辑上看与CSMA/CD总线拓扑的功能是一样的.
### IEEE802.4令牌总线
符合IEEE802.3标准的网络产品广泛应用于办公自动化系统,却无法应用到实时性很强的工厂自动化系统中,主要由两个原因:一是IEEE802.3采用无序竞争机制,且采用二进制指数退避算法解决冲突,无法预知一个帧要经过多长时间才能发送出去;二是IEEE802.3没有优先级,无法保证重要信息的优先传送.
环网中每个站点轮流发送数据,还可以限定每个站每次发送的帧数或时间,可以预知一个帧最多经过多长时间能够发送出去;另外环网中数据帧和令牌都带有优先级,只有优先级不低于令牌优先级的帧才能获准发送,这就可以保证重要信息的优先传送.但从网络的可靠性来看,由于环接口是有源器件,其可靠性不如总线网高;另外环形也不适用于大多数装配生产线的线性拓扑结构.
为此设想总线网和环网的有点集中起来,物理上采用总线结构以获得较高的物理可靠性,但在逻辑上采用令牌环的工作原理,使各站轮流获得发送权,这就是IEEE802.4标准定义的令牌总线网.
1. 工作原理
在物理上,令牌总线是一根线形或树形的电缆,在其上接着若干站点.但在逻辑上,所有工作的站点都组织在一根逻辑环里面,且被按照地址从高到低的顺序进行排列,最低地址后面紧接着最高地址,环中每个站点只知道它的直接前驱和直接后继的地址.
令牌是按地址从高到低的顺序进行传递的,当一个站点发完数据后,在令牌中填入其后继站的地址,并传给后继站;后继站中有数据就可以发送,没有数据则立即将令牌往下传;因此,令牌在逻辑环中循环流动,各站点轮流发送,没有冲突.令牌总线中的令牌需要携带地址.因为总线本质上是一个广播信道,事实上所有的站都收到了总线的数据,只是将地址与自身不相符的帧丢掉而已.同样,令牌也能被所有的站点收到,但只有地址相符的站才允许获得令牌.因此在令牌总线中,站的地理位置并不重要,在环上相邻的站,在物理连接上并不需要是相邻的.
令牌总线的控制比较复杂,在系统启动时,逻辑环并不存在,需要进行环初始化,使得有且仅有一个站点获得令牌加入环中;同时逻辑环是一个动态的环,不断地有新的站点要求加入,同时也不断的有站点因为关机或故障从环中删除,因此还要实现站的动态插入和删除;另外,网络出现故障如令牌丢失、地址重复、重复令牌时,必须能做出相应的处理
2. 故障处理
    1. 逻辑环中断.逻辑环中断,一般是由于环上某些站故障、关机或总线断开,致使令牌无法按照原有的顺序传递.这种故障令牌传递算法即可解决,当最后逻辑环重建失败时,需要检查电缆或设备硬件是否有问题.
    2. 令牌丢失.当令牌持有站出现故障时,就会造成令牌丢失,其表现是总线上没有站点发送数据.每个站点利用不活动计时器来计算总线空闲的时间,每当总线上出现信号时即复位计时器,而当计时器超时时,即发送一个"Claim_Token"控制帧,进行环初始化.
    3. 重复令牌.当某个持有令牌的站发现其他站正在发送数据时,即丢弃自己的令牌.这样,如环上有多个令牌,则经过一段时间后,最后只剩下一个令牌;如果不行令牌全部丢失,那么总线空闲一段时间后,就会有站点发送"Claim_Token"帧,进行环初始化.

### IEEE802.5令牌环
令牌环网最早于1969年在美国贝尔实验室的newhall环上采用,1985年IBM公司推出了IBM令牌环网,该网络成为IEEE802.5标准的基础.环并不是真正的广播介质,而是由一系列点-点链路组成的闭合环路,因而可以使用双绞线、同轴电缆、光纤等多种传输介质,甚至环的各段也可以使用不同的介质,而且环是公平的,信道访问时间有一个确定的上限.
### 令牌环工作原理
1. 在令牌环网中,发送站可以一边发送数据,一边将返回的数据取消,因此对帧的最大长度没有限制,但对环的最小长度是有限制的,因为环的长度至少要能容纳下整个令牌在其上轮转.
实际操作过程中,环路上的每个接口都会引入延迟.接口延迟时间的存在,相当于增加了环路上的信号传播时延,也即等效于增加了环路的比特长度.所以,接口引入的延迟同样也可以用比特来度量.一般,环路上每个接口相当于增加了1比特延迟,则整个环的长度中,如环上共有10个站点,每个站的环接口处引入1比特延迟,则整个环可同时容纳5+10=15比特.环的比特长度就是指环上能同时容纳的比特数,上述1Mb/s的环的比特长度即为5比特.由此,可给出以比特度量的环长计算式:
环的比特长度=信号传播时延*数据传输速率+接口延迟位数=环路介质长度*5($\mu$s/km)*数据传输速率+接口延迟位数
式中5$\mu$s/km即信号传输速度200m/ $\mu$s的倒数.
如果由于环路介质长度太短或站点数太少,以至于环路的比特长度不能满足数据帧长度的要求,则可以在每个环接口引入额外的延迟,如使用以为寄存器等.
2. 环形网络.令牌环在物理上是一个由一系列环接口和这些接口间的点-点链路构成的闭合环路,各站点通过环接口连到黄网.对介质具有访问权的某个发送站点,通过环接口出径链路将数据帧串行发送到环上;其余各站点边从各自的环接口入径链路逐位接收数据帧,同时通过环接口出径链路再生、转发出去,是数据帧在环上从一个站点至下一个站地环行,所寻址的目的站点在数据帧经过时读取其中的信息;最后,数据帧经环一周返回发送站点,并由其从环上撤除所发的数据帧.
由点-点链路构成的环路虽然不是真正意义上的广播介质,但环上运行的数据帧仍能被所有的站点接收到,而且任何时刻仅允许一个站点发送数据,因此同样存在发送权竞争问题.为了解决竞争,可以使用一个称为令牌(Token)的特殊比特模式,使其沿着环路循环.规定只有获得令牌的站点才有权发送数据帧,完成数据发送后立即释放令牌以供其他站点使用.由于环路中只有一个令牌,因此任何时刻至多只有一个站点发送数据,不会产生冲突.而且,令牌环上各站点均有相同的机会公平的获取令牌.

### 令牌环的操作过程:
1. 网络空闲时,只有一个令牌在环路上绕行.令牌是一个特殊的比特模式,其中包含一位"令牌/数据帧"标志位,标志位为"0"表示该令牌为可用的空令牌,标志位为"1"表示有站点正占用令牌在发送数据帧.
2. 当一个站点要发送数据时,必须等待并获得一个令牌,将令牌的标志位置为"1",随后便可发送数据.
3. 环路中的每个站点边转发数据,边检查数据帧中的目的地址,若为本站点的地址,便读取其中所携带的数据
4. 数据帧绕环一周后返回时,发送站将其从环路上撤销.同时根据返回的有关信息确定所传送数据有无出错.若有错则重发存于缓冲区的待确认帧,否则释放缓冲区中的待确认帧.
5. 发送站点完成数据发送后,重新产生一个令牌传至下一个站点,以使其它站点获得发送数据帧的许可权.
3. 令牌环的维护.令牌环的故障处理功能主要体现在对令牌和数据帧的维护上.令牌本身就是比特串,绕环传递过程中也可能受干扰而出错,以致造成环路上无令牌循环的差错;另外,当某站点发送数据帧后,由于故障而无法将所发出的数据帧从网上撤销时,又会造成网上数据帧持续循环的差错.令牌丢失和数据帧无法撤销,是环网上最严重的两种差错,可以通过在环路上指定一个站点作为主动令牌管理站,以此来解决这些问题.
主动令牌管理站通过一种超时机制来检测令牌丢失的情况,该超时值比最长的帧为完全遍历环路所需的时间还要长一些.如果在该时段内没有检测到令牌,便认为令牌已经丢失,管理站将清除环路上的数据碎片,并发出一个令牌.
为了检测到一个持续循环的数据帧,管理站在经过的任何一个数据帧上置其监控位为1,如果管理站检测到一个经过的数据帧的监控位已经置为1,便知道有某个站未能清除自己发出的数据帧,管理站将清除环路上的残余数据,并发出一个令牌.

### 令牌环的特点
令牌环网上的轻负荷时,由于存在等待令牌的时间,故效率较低;但在重负荷时,对各站公平访问且效率高.
考虑到帧内数据的比特模式可能会与帧的首尾定界符形式相同,可在数据段采用比特插入法或违法码法,以确保数据的透明传输.
采用发送站点从环上收回帧的策略,具有对发送站点自动应答的功能;同时这种策略还具有广播特性,即可有多个站点接收同一数据帧.
令牌环的通信量可以加以调节,一种方法是通过允许各站点在其受到令牌时传输不同量的数据;另一种方法是通过设定优先权使具有较高优先权的站点先得到令牌.
### 以比特度量的环长的计算
环长的比特度量.环的长度往往折算成比特数来度量,以比特度量的环长度反映了换上能容纳的比特数量.假如某站点从开始发送数据帧到该帧发送完毕所经历的时间,等于该帧从开始发送经循环返回到发送点所经历的时间,则数据帧的所有比特正好布满整个环路.换言之,当数据帧的传输时延等于信号在环路上的传播时延时,该数据帧的比特数就是以比特度量的环路长度.
所谓一个比特的物理长度是1是指1比特在环上占有的长度.如果环的数据速率是RMb/s,则每1/R$\mu$s发送1比特,同轴电缆上典型的信号传播速度为200m/$\mus$,则1比特在环上占据的物理长度即为200/R米.对于一个速率为1Mb/s的环网,每比特物理长度为200米,如果环周长为1000米,不考虑环接口上的延迟,则环上同时只能容纳5比特,即环的比特长度为5.
### IEEE802.5令牌环格式
1. IEEE802.5MAC帧格式.IEEE802.5令牌环的MAC帧有两种基本格式:令牌帧和数据帧
令牌帧:
| 1  | 1  | 1  | 字节 |
|----|----|----|------|
| SD | AC | ED |
数据帧:
| 1  | 1  | 1  | 2或6 | 2或6 | >=0  | 4   | 1  | 1  | 字节|
|----|----|----|------|------|------|-----|----|----|-----|
| SD | AC | FC | DA   | SA   | 数据 | FCS | ED | FS |
SD:起始定界符
AC:访问控制
FC:帧控制
DA:目的地址
SA:源地址
FCS:帧校验序列
ED:结束定界符
PS:帧状态
令牌帧只有3个字节长,数据帧则可能很长.这两种帧都有一对起始定界符SD和结束定界符ED用于确定帧的边界,它们中各有4位采用曼彻斯特编码中不使用的违法码("高-高"电平对和"低-低"电平对),以实现数据的透明传输
访问控制字段AC的格式如下:
| P | P | P | T | M | R | R | R |
|---|---|---|---|---|---|---|---|
其中T为令牌/数据帧的标志位,该位为"0"表示令牌,为"1"表示数据帧.当某个站点要发送数据并获得了一个令牌后,将AC字段中的T位置"1".此时,SD、AC字段就作为数据帧的头部,随后便可发送数据帧的其余部分.M为监控为,用于检测环路上是否存在持续循环的数据帧.PPP(3比特)为优先级编码,当某站点要发送一个优先级为n的数据帧时,必须获得一个PPP编码值<=n的令牌才可发送.RRR(3比特)为预约编码,当某站点要发送数据帧而信道又不空时,可以在转发其他站点的数据帧时将自己的优先级编码填入RRR中,但该数据帧发送完毕,产生的令牌便具有了预约的优先级.若RRR已被其他站点预约了更高的优先级,则不可再预约.将令牌的优先级提升了的站点,在数据帧发送完毕后,还要负责将令牌的优先级降下来,这样就使优先级较低的站点也有发送数据帧的机会.
帧控制字段FC中的前两位标志帧的类型."01"表示为一般信息帧,即其中的数据字段为上层提交的LLC帧;"00"表示为MAC控制帧,此时其后的6位用以区分控制帧的类型.信息帧只发送给地址字段所指示的目的站点,控制帧则发送给所有的站点.控制帧中不含数据字段.
数据字段的长度没有下限,但其上限受站点令牌持有时间的限制.令牌持有时间的缺省值为10毫秒,数据帧必须在该时段内发送完,超过令牌持有时间,必须释放令牌.
32位的帧校验序列FCS的作用范围自帧控制字段FC起至FCS止,其中不包括帧首(SD、AC字段)和帧尾(ED、FS字段).
帧状态字段FS的格式如下:
| A | C | X | X | A | C | X | X |
|---|---|---|---|---|---|---|---|
|---|---|---|---|---|---|---|---|
字段中设置了两位A和两位C,其余4位未定义.A位为地址识别位,发送站发送数据帧时将该位置"0",接收站确认目的地址与本站相符后将该位置"1".C为帧复制位,发送站发送数据帧时将位置"0",接收站接收数据帧后将该位置"1".当数据帧返回发送站时,A、C位作为应答信号使发送站了解数据帧发送的情况.若返回的AC=11,表示接收站已收到并复制了数据帧;若AC=10,表示接收站存在,但由于缓冲区不够或其它原因未接收数据帧,可等待一段时间后再重发.由于FS字段不在FCS校验范围内,所以使用两套重复的A、C以提高可靠性.
结束定界符ED除了用于指示帧的结束边界外,其最后一位E还用作差错位,发送站发送数据帧时将该位置"0".此后,任何一个站点在转发数据帧时,通过FCS校验一旦发现有错,都可以将E位置"1".这样,当数据帧返回时,发送站便可了解数据帧的传输情况.
2. IEEE802.5的介质访问控制功能.令牌环局域网协议标准包括四个部分:逻辑链路控制(LLC)、介质访问控制(MAC)、物理层(PHY)和传输介质,IEEE802.5规定了后面三个部分的标准.令牌环的介质访问控制功能如下:
    1. 帧发送:采用沿环传递令牌的方法来实现对介质的访问控制,取得令牌的站点具有发送一个数据帧或一系列数据帧的机会.
    2. 令牌发送:发送站完成数据帧发送后,等待数据帧的返回.在等待期间,继续发送填充字符.一旦源地址与本站相符的数据帧返回后,即发送令牌.令牌发送之后,该站仍保持在发送状态,直到该站发送的所有数据帧从环路上撤销为止.
    3. 帧接收:若接收到的帧为信息帧,则将FC、DA、SA、Data及FS字段复制到接收缓冲中,并随后将其转至适当的子层.
    4. 优先权操作:访问控制字段中的优先权位和预约位配合工作,使环路服务优先权与环上准备发送的PDU最高优先级匹配.

### IEEE802.3、IEEE802.4和IEEE802.5的比较
IEEE802.3、IEEE802.4和IEEE802.5这3中局域网标准采用了大致相同的技术并且具有大致相似的功能.
IEEE802.3总线网由于结构简单、安装容易、协议简单及总线可靠性高而成为应用最为广泛的局域网,在轻负载时可以获得很好的延迟特性,甚至可以达到零延迟.
但IEEE802.3总线网在网络负载增加时,大量的冲突会引起网络性能下降;随机争用和退避等待机制无法预知数据传输的最大延迟,也不提供优先级支持,因此不适用实时系统;大量使用模拟器件和模拟技术,增加了设备的复杂性及不可靠性;为了进行冲突检测必须限制帧的最小长度,处理短帧时需要添加一定的填充字符,增加了额外开销;电缆长度被限制在2.5公里内,网络规模不易扩充.
IEEE802.4令牌总线网使用可靠性较高的宽带同轴电缆,可以同时支持多个通道;使用令牌轮换发送权以避免冲突,在重载下可以获得很高的传输效率;采用公平的优先级机制,保证各种优先级的数据都能占有一定的宽带发送,并可预知数据传输的最大延迟,适用于实时系统;不需限制真的最小长度,但对最大帧长有限制.
但IEEE802.4令牌总线网也使用了大量的模拟设备和技术,设备复杂而且代价昂贵;即使低负载时也必须等待令牌才能发送,延迟特性较差;采用分布式的控制策略,协议相当复杂;这种网络用户使用的比较少.
IEEE802.5令牌环网使用点-点的连接,可以使用多种传输介质,而且可以采用全数字技术;使用线路中心的令牌环网是唯一可以自动检测和隔离网络故障的局域网;支持优先级,支持短帧,最大帧长只受令牌持有时间限制,在重负载下可以获得很高的传输效率.
但IEEE802.5令牌环网在低负载下时延较大,这与令牌总线网相同;它的优先级策略和低优先级不公平;采用集中式控制,对监控站的可靠性要求较高,监控站成为网络中最为脆弱的部分.
因此,单从性能角度比较这三种局域网技术的优劣是没有意义的,对局域网技术的选择往往要从网络性能、网络用途、网络规模和网络代价等多方面来综合考虑.在很重的负载下IEEE802.3总线网彻底不能用,而基于令牌的IEEE802.4总线网或IEEE802.5环网却可以达到接近于100%的效率;若负载范围从轻到中等,则3中局域网都可以胜任.
### IEEE802.6:分布队列双总线
由于城域网的覆盖范围远远超出局域网的覆盖范围,无法使用前面介绍的局域网技术来构建城域网,IEEE为都市建网定义了一种城域网标准,即IEEE802.6标准的分布式队列双总线(Distributed Queue Dual Bus,DQDB).
DQDB两条平行的单向总线穿绕于整个城市,每个站点同时连接到两条总线上.每条总线都有一个首段,它能产生一个稳定的53字节的信元流.每个信元从首端沿着总线往下传,当它到达终点时,就从总线上消失.
每个信元带有44字节的有效载荷.每个信元中带有两个协议位:Busy(繁忙),其值为1表示信元已被占用;Request(请求),当站点想发送请求时可将其置为1.
在发送信元之前,站点必须知道目的站点位于其左方还是右方.如果目的站点位于右方,发送站点就用总线A,否则就是用总线B.数据通过硬件或运算电路输入到相应的总线中,因此,一个站点失效不会影响整个网络的正常运行.
与所有其它IEEE802局域网标准不同,IEEE802.6并不贪婪.在其它的网络中,如果站点获得机会发送,它就发送.而在IEEE802.6中,站点按照准备好的发送顺序进行排队,并按照先进先出(FIFO)的原则进行发送.因此,最为关键的问题就是在没有集中排队的情况下,如何实现先进先出.
DQDB采用的基本原则是站点必须有礼貌:在其下方站点完全发送完后自己才可以发送,这是为了防止以下情况发生:离首端最近的站点把经过它的所有空信元全部捕获并填入内容,致使其后的站点处于饥饿状态.因为两条总线的工作机制完全相同,为了简单起见,这里只讨论总线A上的传送.
为了模拟FIFO队列,每个站点均保持有两个计数器:请求计数器(Request Counter,RC)和倒计数计数器(Countdown Counter,CD).RC对本站下方未响应的请求进行计数,直到本站有数据要发送为止.在停止计数的同时,将RC的值复制到CD中,然后RC置为0,并对此后下方的请求进行计数.
现在已经有很多城市中安装了DQDB城域网.典型的DQDB的覆盖范围是160km,数据传输速率为44.736Mb/s(T3).
## 高速局域网
### 光纤分布数据接口FDDI
光纤分布数据接口FDDI(Fiber Distributed Data Interface)是以光纤作为传输介质的高性能令牌环网,它的逻辑拓扑结构是一个环,更确切的说是逻辑计数循环环(Logical Counter Rotation Ring),它的物理拓扑结构可以是环形、带树形的环或带星形的环.FDDI的数据传输速率可达100Mbps.FDDI可在主机与外设之间、主机与主机之间、主干网与IEEE802低速网之间提供高带宽和通用目的的互连.FDDI使用基于IEEE802.5令牌环标准的令牌传递协议,使用IEEE802.2标准定义的LLC协议,与IEEE802局域网兼容
### FDDI的性能
FDDI数据传输速率达100Mbps,采用4B/5B编码,要求信道介质的信号传输速率达到125Mbaud.FDDI网最大环路长度为200km,最多可有1000个物理连接.若采用双环结构时,站点距离在2km以内,且每个站点与两个环路都有链接,则最多可连接500个站点,其中每个单环长度限制在100km内.
FDDI网络是由许多通过光传送介质连接成一个或多个逻辑环的站点组成的,因此与令牌环类似,也是把信息发送至环上,从一个站到下一个站一次传递,当信息经过指定的目的站时就被接收、复制,最后,发送信息的站点再将信息从环上撤销.因此FDDI标准和令牌环介质访问控制标准IEEE802.5十分接近.FDDI和802.5的主要特征比较如下:
| 特性       | FDDI             | 802.5              |
|------------|------------------|--------------------|
| 介质类型   | 光纤             | 屏蔽双绞线         |
| 数据速率   | 100Mbps          | 4Mbps              |
| 可靠性措施 | 可靠性规范       | 无可靠性规范       |
| 数据编码   | 4B/5B编码        | 差分曼彻斯特编码   |
| 编码效率   | 50%              | 80%                |
| 时钟同步   | 分布式时钟       | 集中式时钟         |
| 信道分配   | 定时令牌循环时间 | 优先级位           |
| 令牌发送   | 发送后产生新令牌 | 接受完后产生新令牌 |
| 环上帧数   | 可多个           | 最多一个           |
### FDDI数据编码
FDDI规定了一种很特殊的定时和同步方法.在网络中使用的代码最好是那种信号状态变化频繁的代码,这些状态变化使得接收器能够持续的与输入信号相适应,这样就保证了发送设备与接收设备之间的同步.在IEEE802.3标准中使用曼彻斯特编码只有50%的效率,因为每一比特都要求线路上有2次的状态变化(即2Baud).如果采用曼彻斯特编码,那么100Mbps传输速率就要求200MBaud的调制速率,也即200MHz的带宽.换言之,曼彻斯特编码需要发送数据的2倍带宽.
考虑到生成200MHz的接口和时钟设备会大大增加成本,ANSI设计了一种称为4B/5B的代码.在这种编码技术中,每次对4位数据进行编码,每4位数据编码成5位符号,用光的存在和不存在表示5位符号中每一位是1还是0.这样,对于100Mbps的光纤网只需125MHz的元件就可实现,使效率提高到80%.
为了得到信号同步,可以采用二级编码的方法.即先按4B/5B编码,然后再利用一种称为倒相的不归零制NRZI编码.该编码确保无论4比特符号为何种组合,其对应的5比特编码中至少有2位"1",从而保证在光纤中传输的光信号至少发生两次跳变,以利于接收端的时钟提取.这个原理类似于差分编码.
5比特编码的32种组合中,实际只使用了24种,其中的16种用作数据符号,其余8种用作控制信号.所有16个4位数据符号,经编码后的5位码中"1"码至少为2位,按NRZI编码原理,信号中就至少有两次跳变,因此接收端可得到足够的同步信息.
### FDDI时钟偏移
在一般的环形网中,采用只有一个主时钟的集中式时钟方案,在绕环运行时,时钟信号会偏移.每个站点产生的偏移,积累起来还是很客观的.为了消除这种时钟偏移现象,采用一种称为弹性缓冲器来消除这种偏移.但即使采用了这种措施,由于偏移积累的缘故,限制了环网的规模.
这种集中式时钟方案,对100Mbps高速率的光纤网来说是不适用的.100Mbps光纤网中每一位的时间为10ns.因此,时钟偏移的影响更严重,如采用集中式时钟方案,就需在每个站点配置锁和相电路,成本会很高.
因此,FDDI标准规定使用分布式时钟方案,即在每个站点都配置有独立的时钟和弹性缓冲器.进入站点缓冲器的数据时钟是按照输入信号的时钟确定的,而从缓冲器输出的信号时钟则根据站点的时钟确定,这种方案使环路中中继器的数目不受时钟偏移因素的限制.
### FDDI工作原理、帧格式、FDDI组成
FDDI标准以MAC实体间交换的MAC符号来表示帧结构,每个MAC符号对应4个比特,这是因为在FDDI物理层中,数据是以4位为单位来传输的.FDDI的令牌帧和数据帧的格式如下:
令牌帧:
| 8       | 1  | 1  | 字节 |
|---------|----|----|------|
| 前导码P | SD | FC | ED   |
数据帧:
| 8       | 1  | 1  | 2或6 | 2或6 | >=0 | 4   | 0.5 | 0.5n | 字节 |
|---------|----|----|------|------|------|-----|-----|------|------|
| 前导码P | SD | FC | DA   | SA   | INFO | FCS | ED  | FS   |
FD:起始定界符
FC:帧控制
DA:目的地址
SA:源地址
FCS:帧校验序列
ED:结束定界符
FS:帧状态
前导码P用以在收发双方实现时钟同步.发送站点以16个4位空闲符号(64个比特)作为前导码
起始定界符SD占一个字节,由两个4比特MAC非数据符号组成.
帧控制字段FC占一个字节,其格式为:
| C | L | F | F | Z | Z | Z |
|---|---|---|---|---|---|---|
|---|---|---|---|---|---|---|
其中C表示是同步帧还是异步帧,L表示是使用2字节(16位)地址还是6字节(48位)地址,FF表示是LLC数据帧还是MAC控制帧,若为MAC控制帧,则用最后4位ZZZZ来表示控制帧的类型
目的地址字段DA和源地址字段SA可以是2字节或6字节地址.
数据字段用于装载LLC数据或与控制操作有关的信息.FDDI标准规定最大帧长为4500字节.
帧校验序列FCS为4个字节(32比特)长
结束定界符ED,对令牌来说站2个MAC控制符号(共8比特);其它帧则只占一个MAC控制符号(即4比特),用于与非偶数个4比特MAC控制符号的帧状态字段FS配合,以确保帧的长度为8比特的整数倍.
帧状态字段FS用于返回地址识别、数据差错及数据复制等状态,每种状态用一个4比特MAC控制符号来表示
忧伤可见,FDDI MAC帧与802.5的MAC帧十分相似,不同之处是FDDI帧含有前导码,这对高数据速率下的时钟同步十分重要;允许在网内使用16位和48位地址,比802.5更灵活;令牌帧也有不同,没有优先位和预约位,而用别的方法分配信道使用权.
虽然FDDI和802.5都采用令牌传递的协议,但二者还是存在着一个重要差别,即FDDI协议规定发送站点发送完帧后,可立即发送新的令牌帧,而802.5规定当发送出去的帧的前沿会送至发送站时,才发送新的令牌帧.因此FDDI协议具有较高利用率的特点,特别在打的环网中显得更为明显.
### 以太网、100Mbps、1Gbps、10Gbps以太网的体系结构
传统以太网是10Mbps的系带总线局域网,采用10BASE5,10BASE2或10BASE-T作为传输介质,各站点共享共用信道,任何一个站点所发送的数据均沿着介质以广播方式传输,总线上其他所有站点均可以接受到.由于协议简单、安装方便而得到广泛应用,但其有限的带宽成为系统的"瓶颈".
介质访问控制方法:
IEEE于1995年通过了100Mbps快速以太网的10BASE-T标准,并正式命名为IEEE802.3u标准,作为对IEEE802.3标准的补充.100BASE-T标准不但在最大程度上保持了IEEE802.3标准的完整性,而且保留了核心以太网的细节规范.
虽然100BASE-T仍采用常规10Mpbs以太网的CSMA/CD介质访问控制方法,但其性能是10BASE-T的10倍,而价格仅为其一半.100BASE-T的MAC与10BASE-T的MAC相比,除了帧际间隙缩短到原来的1/10外,两者的帧格式及参数完全相同.100BASE-T的MAC也可以运行于不同的速率,并能与不同的物理层接口.这样,原先10Mbps以太网上运行的软件不加任何修改即可在快速以太网上运行,原先的协议分析和管理工具也可轻易的被继承.
为了能成功地进行冲突检测,100BASE-T也必须满足"最短帧长=冲突检测时间*数据传输速率"的关系.其中冲突检测时间等于网络中最大传播时延的2倍.100BASE-T与10BASE-T的MAC帧相同,两者的最短帧长均为64字节(512比特),但由于100BASE-T的数据速率提高了10倍,故相应的冲突检测时间缩短为10BASE-T的1/10,由此整个网络的直径(任何两站点间的最大距离)也减小到10BASE-T的1/10.
物理层
100BASE-T和10BASE-T的区别在物理层标准和网络设计方面.100BASE-T的物理层是包含三种介质选项:100BASE-TX、100BASE-FX和100BASE-T4
100BASE-T物理层介质选项
|          | 100BASE-TX     | 100BASE-FX | 100BASE-T4      |
|----------|----------------|------------|-----------------|
| 传输介质 | 2对STP或5类UTP | 2对光纤    | 4对3、4或5类UTP |
| 传输信号 | 4B/5B NRZI     | 4B/5B NRZI | 8B/6T NRZ       |
| 数据速率 | 100Mbps        | 100Mbps    | 100Mbps         |
| 每段长度 | 100m           | 100m       | 100m            |
| 物理范围 | 200m           | 400m       | 200m            |
STP:屏蔽双绞线
UTP:非屏蔽双绞线
NRZ:不归零制编码
NRZI:差分不归零制编码
1. 100BASE-TX和100BASE-FX.100BASE-TX和100BASE-FX均采用两对链路,其中一对用于发送,另一对用于接收,每对链路实现单方向的100Mbps数据速率.100BASE-TX使用屏蔽双绞线或5类非屏蔽双绞线,100BASE-FX则使用光纤.
100BASE-TX和100BASE-FX都使用高效的4B/5B NRZI编码.NRZI为差分不归零制编码,这种编码与常规的不归零制编码的区别在于每个"1"码开始出都有跳变、每个"0"码开始处没有跳变.在NRZI编码中,信号通过相邻码元极性的跳变来解码,而不是简单地以绝对电平为准,由此可获得更高的抗干扰能力.
2. 100BASE-T4.100BASE-T4是为在低质量要求的3类非屏蔽双绞线上实现100Mbps数据速率而设计的,该规范也可使用4类或5类非屏蔽双绞线.
要想直接用一对3类非屏蔽双绞线获取100Mbps的数据速率几乎是不可能的.因此100BASE-T4采用一种称为8B/6T的编码方案.该方案将原始数据流分为3股子数据流,经4对子信道D1~D4传输,每个子信道的数据速率为33.3Mbps.其中D1、D3、D4用于发送,D2、D3、D4用于接收.因此,D3、D4被配置为双向传输.另外,D2即可用于接收,又用于冲突检测.每个子信道中,将8位数据为单位映射成一个6位的信号码组,这样,子信道的信号传输速率便为33.3X(6/8)=25Mbaud.
### 以太网、100Mbps、1Gbps、10Gbps以太网的物理层规范、MAC方法
随着多媒体技术、网络分布计算、桌面视频会议等应用的不断发张,用户对局域网的带宽提出了更高的要求;同时,100M快速以太网也要求主干网、服务器以及有更高的带宽.另外,由于以太网的简单、实用、廉价及应用的广泛性,人们又迫切要求高速网技术与现有的以太网保持最大的兼容性.千兆以太网技术就是在这种需求背景下开始酝酿的.1996年3月成立的IEEE802.3Z工作组,专门负责千兆以太网的研究,并制定相应的标准.
千兆以太网使用原有以太网的帧结构、帧长及CSMA/CD协议,只是在底层将数据速率提高到了1Gbps.因此,它与标准以太网及快速以太网兼容,用户能在保留原有操作系统、协议结构、应用程序及网络管理平台与工具同时,通过简单的修改,使现有的网络工作站廉价地升级到千兆位速率.
### 千兆以太网的物理层协议
千兆以太网的物理层协议包括1000BASE-SX、1000BASE-LX、1000BASE-CX和1000BASE-T等标准.
1. 1000BASE-SX.使用芯径为50 $\mu$m及62.5 $\mu$m、工作波长为850nm的多模光纤,采用8B/10B编码方式,传输距离分别为260m和525m,适用于建筑物中同一层的短距离主干网.
2. 1000BASE-LX.使用芯径为50 $\mu$m即62.5 $\mu$m的多模、单模光纤,工作波长为1300nm,采用8B/10B编码方式,传输距离分别为525m,550m和3000m,主要用于校园主干网.
3. 1000BASE-CX.使用150$\Omega$平衡屏蔽双绞线(STP),采用8B/10B编码方式,传输速率为1.25Gbps,传输距离为25m,主要用于集群设备的连接,如一个交换机房内的设备互连.
4. 1000BASE-T.使用4对5类非屏蔽双绞线(UTP),传输距离为100m,主要用于结构化布线中同一层建筑的通信,从而可以利用以太网或快速以太网已铺设的UTP电缆.
### 千兆以太网的MAC子层
MAC子层的主要功能包括数据帧的封装/卸装、帧的寻址与识别、帧的接收与发送、链路的管理、帧的差错控制及MAC协议的维护.
千兆以太网的帧结构与标准以太网的帧结构相同,其最大帧长为1518字节,最小帧长为46字节.
千兆以太网对介质的访问采用全双工和半双工两种方式.全双工方式适用于交换机到交换机或交换机到站点之间的点-点连接,两点间可同时进行发送与接收,不存在共享信道的争用问题,所以不需采用CSMA/CD协议.半双工方式则适用于共享介质的连接方式,仍采用CSMA/CD协议解决信道的争用问题.
千兆以太网的数据速率为快速以太网的10倍,若要保持两者最小帧长的一致性,势必太大缩小千兆以太网的网络直径;若要维持直径为200m,则最小帧长要512字节.为了确保最小帧长为64字节,同时维持网络直径为200m,千兆以太网采用了载波扩展和数据包分组两种技术.
载波扩展技术用于半双工的CSMA/CD方式,实现方式是对小于512字节的帧进行载波扩展,使这种帧所占有的时间等同于长度为512字节的帧所占用的时间.虽然载波扩展信号不携带数据,但由于它的存在保证了200m的网络直径.对于>=512字节的帧,不必添加载波扩展信号.若大多数帧短于512字节,则载波扩展技术会使带宽利用率下降.
数据包分组技术允许站点每次发送多帧,而不是一次发送一帧.若多个连续的数据帧短于512字节,仅其中的第一帧需要添加载波扩展信号.一旦第一帧发送成功,则说明发送信道已打通,其后续帧就可不加载波扩展连续发送,只需帧间保持12字节的间隙即可.
由于全双工方式不存在冲突问题,所以不需任何处理即可传输64字节的最小数据帧.
### 千兆以太网的特点
一方面为了保持从标准以太网、快速以太网到千兆以太网的平滑过渡;另一方面又要兼顾新的应用和新的数据类型,在千兆以太网研究过程中应注意以下特点:
1. 简易性:千兆以太网应保持经典以太网的技术原理、安装实施和管理维护的简易性,这是千兆以太网成功的基础之一.
2. 技术过渡的平滑性:千兆以太网保持了经典以太网的主要技术特征,采用CSMA/CD介质管理协议,采用相同的帧格式及帧的大小,支持全双工、半双工工作方式,以确保平滑过渡.
3. 网络可靠性:保持经典以太网的安装、维护方法,采用中央集线器和交换机的星形结构和结构化布线方法,以确保千兆以太网的可靠性.
4. 可管理性与可维护性:采用简易网络管理协议(SNMP)及经典以太网的故障查找与排错工具,以确保千兆以太网的可管理性与可维护性.
5. 经济性:网络成本包括设备成本、通信成本、管理成本、维护成本及故障排除成本.由于集成了经典以太网的技术,使千兆以太网的整体成本下降.
6. 支持新应用与新数据类型:计算机技术和应用的发展,出现了许多新的应用模式,对网络提出了更高的要求.为此,千兆以太网必须具有支持新应用与新数据类型的能力.
### 万兆以太网
万兆以太网技术与千兆以太网类似,仍然保留了以太网帧结构.通过不同的编码方式或波分复用提供10Gbit/s传输速度.所以就其本质而言,10G以太网仍然是以太网的一种类型.
10G以太网与2002年6月在IEEE通过.10G以太网包括10GBASE-X、10GBASE-R和10GBASE-W.10GBASE-X使用一种特紧凑包装,含有一个较简单的WDM期间、4个接收器和4个在1300nm波长附近以大约25nm为间隔工作的激光器,每一对发送器/接收器在2.125Gbit/s速度下工作.10GBASE-R是一种使用64B/66B编码的串行接口,数据流为10.000Gbit/s,因而产生的时钟速率为10.3Gbit/s.10GBASE-W是广域网接口,与SONET OC-192兼容,其时钟为9.953Gbit/s,数据流为9.585Gbit/s.
万兆以太网的特性如下:
1. 万兆以太网不在支持半双工数据传输,所有数据传输都以全双工方式进行,这不仅极大地扩展了网络的覆盖区域,而且使标准得以大大简化.
2. 为使万兆以太网不但能以更优的性能为企业骨干网服务,更重要的是,还要从根本上对广域网以及其它长距离网络应用提供最佳支持,尤其是还要与现存的大量SONET网络兼容.该标准对物理层进行了全新定义.新标准的物理层分为两部分,分别为LAN物理层和WAN物理层.LAN物理层提供了现在正广泛应用的以太网接口,传输速率为10G;WAN物理层提供了与OC-192c和SDH VC-4-64c相兼容的接口,传输速率为9.58G.与SONET不同的是,运行在SONET上的万兆以太网依然以异步方式工作.WIS(WAN接口子层)将万兆以太网流量映射到SONET的STS-192c帧中,通过调整数据包间的间距,使OC-192c的略低的数据传输率与万兆以太网相匹配.
3. 万兆以太网有5种物理接口.千兆以太网的物理层每发送8比特的数据要用10个比特组成编码数据段,网络带宽的利用率只有80%;万兆以太网则没发送64比特只有66个比特组成编码数据段,比特利用率达97%.虽然这是牺牲了纠错位和而换取的,但万兆以太网采用了更先进的纠错和恢复技术,确保数据传输的可靠性.
新标准的物理层可进一步细分为5种具体的接口,分别为1550纳米LAN接口、1310纳米宽频波分复用LAN接口、850纳米LAN接口、1550纳米WAN接口和1310纳米WAN接口.每种接口都有其对应的最适宜的传输介质.850纳米LAN接口适用于在50/125微米多模光纤上,最大传输距离为65米.50/125微米多模光纤现在已用的不多,但由于这种光纤制造容易,价格便宜,所以用来连接服务器比较划算.1310纳米宽频波分复用(WWDM)LAN接口适用于用在62.5/125微米的多模光纤上,传输距离为300米.62.5/125微米的多模光纤又叫FDDI光纤,是目前企业使用的最为广泛的多模光纤,从20世纪80年代末90年代初开始在网络界大行其道.1550纳米WAN接口和1310纳米WAN接口适用于在单模光纤上进行长距离的城域网和广域网数据传输,1310纳米WAN接口支持的传输距离为10公里,1550纳米WAN接口支持的传输距离为40公里.
### 交换性以太网
计算机技术和通信技术的结合促进了计算机局域网的飞速发展,从20世纪60年代末ALOHA的出现到90年代中期1000Mbps交换型以太网的登台亮相,短短30年间经过了从单工到双工,从共享到交换,从低速到高速,从简单到复杂,从昂贵到普及的飞跃.
20世纪80年代中后期,由于通信量的急剧增加,促进了技术的发展,使局域网的性能越来越高.最早的1Mbps的速率已广泛地被今天的100BASE-T替代.但是,传统的介质访问方法都局限于使大量的站点共享对一个公共传输介质的访问,即CSMA/CD模式.
90年代初,随着计算机性能的提高及通信量的剧增,传统局域网已经愈来愈超出了自身的负荷,交换型以太网技术应运而生,大大提高了局域网的性能.交换技术的加入,就可以建立地理位置相对分散的网络,使局域网交换机的每个端口可平行、安全、同时互相传输信息,而且使局域网可以高度扩容.
局域网交换技术的发展要追溯到两端口网桥.桥是一种存储转发设备,用来连接相似的局域网.从互联网网络的结构看,桥是属于DCE级的端到端的连接;从协议层次看,桥是在逻辑链路层对数据帧进行存储转发,桥与中继器在第一层、路由器在第三层的功能相似.两端口网桥几乎是和以太网同时发展的.
以太网交换技术(Switch)是在多端口网桥的基础上于20世纪90年代初发展起来的,实现OSI模型的下两层协议,与网桥有这千丝万缕的关系,甚至被业界人士称为"许多联系在一起的网桥",因此现在的交换式技术并不是什么新的标准而是现有技术的新应用而已,是一种改进了的局域网桥.与传统的网桥相比,它能提供更多的端口、更好的性能、更强的管理功能以及更便宜的价格.现在有的以太网交换机实现了OSI参考模型的第三层协议,实现路由选择功能.以太网交换机又与电话交换机相似,除了提供存储转发方式外还提供其他桥接技术.
## 无线局域网技术
### 无线局域网的特点、技术要求、硬件组成
无线局域网与有线局域网相比有以下诸多优点:
1. 安装便捷:无线局域网的最大优势是免去或减少了网络布线的工作量,一般仅需安装一个或数个接入点设备,便可实现无线局域网的有效覆盖.
2. 使用灵活:在无线局域网的有效信号覆盖范围内,站点可以在任何位置接入网络,而不必受网络设备安放位置的限制.
3. 经济节约:有线局域网必须为预设大量世纪使用率低下的接入点花费不小的开支,而当用户数量和位置发生变更时又要花费较大的开支进行网络改造.无线局域网可以避免或减少这种问题的出现.
4. 易于扩展:无线局域网提供了多种配置方式供用户灵活选择,用户可以组成仅由几个站点的小型局域网,也可以组成拥有上千站点的大型局域网,并且能获得有线网络无法提供的漫游等功能
无线局域网的不足之处是,数据传输速率相对较低,有事会存在通信盲点等.
无线局域网必须支持高速、突发的数据业务,在室内使用还要解决多径衰落以及相邻子网间串扰等问题.具体来说,无线局域网必须实现以下技术要求:
1. 可靠性:时延数据表明,为保证通信系统的可靠性和稳定性、提高网络的有效吞吐量,无线局域网的系统分组丢失率应低于$10^{-5}$、误码率应低于$10^{-8}$.
2. 兼容性:对于室内使用的无线局域网,应尽可能使其跟现有有线局域网在网络操作系统的网络软件上相互兼容.
3. 数据速率:为了能满足局域网业务量的需要,无线局域网的数据传输速率应该至少在1Mbps以上.
4. 通信保密:由于数据通过无线介质在空中传播,无线局域网必须在不同层次采取有效措施以提高通信保密和数据安全性能.
5. 移动性:支持全移动或半移动网络.全移动网络中的站点可在网络覆盖范围内以移动状态与网络通信;半移动网络中的站点可在网络覆盖范围内移动,但与网络通信时以静止状态进行.
6. 节能管理:由于大多数用户一般都使用笔记本电脑连接无线局域网,所以无线局域网应具备节能管理功能,当无数据收发时使站点机处于休眠状态,当有数据收发时再使其处于激活状态,从而达到节省笔记本电脑内电池消耗的目的.
7. 小型化、低价格:这是无线局域网得以使用并普及的关键所在.
8. 电磁环境:无线局域网应考虑电磁波对人体和周边环境的影响问题.
无线局域网的硬件设备有:
1. 无线网卡.无线网卡的作用和以太网中网卡的作用基本相同,它作为无线局域网的接口,能够实现无线局域网各客户机之间的连接与通信.
2. 无线AP.AP是Access Point的简称,无线AP就是无线局域网中接入点、无线网关,它的作用类似于有线网络中的集线器.
3. 无线天线.当无线网络中各网络设备相距较远时,随着信号的减弱,传输速率会明显下降以致无法实现无线网络的正常通信,此时就要借助无线天线对所接收或发送的信号进行增强.
无线局域网协议主要分为两大阵营:IEEE802.11系列标准和欧洲的HiperLan.其中IEEE802.11协议、蓝牙标准和HomeRF工业标准等是无线局域网所有标准中最主要的协议标准.
### 无线局域网的连接方案以及标准,无线应用协议WAP
IEEE802.11是美国电气和电子工程师协会IEEE在1997年6月颁布的无线网络标准.IEEE802.11规定了无线局域网在2.4GHz波段进行操作,这一波段全球无线电法规组织定义为扩频使用波段.标准的802.11主要用于解决办公室局域网和园区网中的用户与用户终端的无线接入,速率最高只能达到2Mbit/s.
### IEEE802.11物理层实现方式
IEEE802.11是早起无线局域网标准之一.该标准定义了物理层和介质访问控制MAC协议的规范,允许无线局域网及无线设备制造商在一定范围内建立互操作网络设备.
与802.3相比,IEEE802.11有如下新特点:在物理层定义了数据传输的信号特征和调制方法,定义了2个射频传输技术和1个红外传输规范共3种不同的物理层实现方式.RF传输标准是直接序列扩频DSSS(direct Sequence Spread Spectrum)和跳频扩频FHSS(Frequency Hopping Spread Spectrum).红外(Infrared,IR)传输规范则是利用红外线实现无线通信的规范.接入速率有1Mbit/s.和2Mbit/s两种.
### MAC结构及服务内容
802.11的MAC子层负责解决客户端工作站和访问接入点之间的连接.当一个802.11客户端进入一个或者多个接入点的覆盖范围时,它会根据信号的强弱以及包错误率自动选择一个接入点进行连接.
无线局域网MAC提供的服务有:安全服务、MAC服务数据单元重新排序服务和数据服务.802.11MAC子层还提供了CRC校验和包分片功能.对于上层协议合格分片的过程完全透明的.
### CSMA/CD协议
802.11的MAC和802.3协议的MAC非常相似,都是在一个共享介质上支持多个用户共享资源,发送方在发送数据前进行网络的可用性检测.802.3协议采用CSMA/CD介质访问控制方法.然而,在无线系统中设备不能够一边接收数据信号一般传送数据信号.
无线局域网中采用了一种与CSMA/CD相类似的载波监听多路访问/冲突防止协议(CSMA/CA)实现介质资源共享.CSMA/CA利用确认信号来避免冲突的发生,也就是说,只有当客户端接收到网络上返回的确认信号才确认送出的数据已经到达目的地.CSMA/CA通过这种方式来提供无线的共享访问,这种方式在处理无线问题时非常有效.以CSMA/CA的方式共享无线介质将时间域的划分与帧格式紧密联系起来,保证某一时刻只有1个站点发送,实现了网络系统的集中控制.
因传输介质不同,CSMA/CD与CSMA/AC的检测方式也不同.CSMA/CD通过电缆中电压的变化来检测,当数据发生碰撞时,电缆中的电压就会随着发生变化;而CSMA/CA采用能量检测(ED)、载波检测(CS)和能量载波混合检测3种检测信道空闲的方式.
### 无线局域网标准IEEE802.11协议系列,蓝牙技术,IrDA和HomeRF技术,IEE802.16协议
### IEEE802.11系列标准
最早的IEEE802.11标准是在1997年提出的,接着在1999年9月又提出了IEEE802.11a和IEEE802.11b两个标准,新近又提出了IEEE802.11g标准.IEEE802.11标准集如下:
| ---- | 802.11  | 802.11b        | 802.11b+          | 802.11a        | 802.11g    |
|------|---------|----------------|-------------------|----------------|------------------|
| 频率 | 2.4GHz  | 2.4GHz         | 2.4GHz            | 5GHz           | 2.4GHz     |
| 带宽 | 2/1Mbps | 11/5.5/2/1Mbps | 22/11/5.5/2/1Mbps | 可达54Mbps     | 可达54Mbps |
| 距离 | 100m    | 100m~300m      | 100m~300m         | 5km~10km       | 5km~10km   |
| 业务 | 数据    | 数据/图像      | 数据/图像         | 语音/数据/图像 | 语音/数据/图像  |
#### IEEE802.11b
802.11b工作于2.4GHz频带,其物理层支持5.5Mbps和11Mbps的传输速率,传输速率可根据环境干扰或传输距离的不同在11Mbps、5.5Mbps、2Mbps、1Mbps之间切换,而且在以2Mbps和1Mbps速率传输时与802.11兼容.802.11b使用Direct Sequence(直接序列)DSSS作为协议,提供数据加密,最高使用128bit的WEP.相对于其他标准,802.11b价格比较低廉,并且能够达到11Mbps的传输速率,因此802.11b产品已经广泛地投入市场,在许多实际场所运行,但802.11b和工作在5GHz的802.11a标准不兼容.
#### IEEE802.11a
802.11a工作于5GHz频带,其物理层速率可达54Mbps,传输层可达25Mbps.它采用正交频分复用(OFDM)的独特技术,可提供25Mbps的无线ATM接口和10Mbps的以太网无线帧结构接口,以及TDD/TDMA的空中接口,一个扇区可接入多个用户,每个用户可带多个用户终端,它的数据加密可达152bit WEP.但802.11a芯片价格昂贵、空中接力不好、点对点连接很不经济.不过由于其传输速率和有效传输距离均远远高于802.11b,所以在带宽要求较高的场所,或是传输距离较远的地方,802.11a仍是用户的首选.
#### IEEE802.11g
802.11g是IEEE与2002年11月15日批准的一种试验性新标准.802.11g和802.11b一样也工作于2.4GHz频带,所以可以完全兼容802.11b,但速度却比802.11b快5倍,能达到802.11a的水平.
#### IEEE802.11b+
802.11b+是一个非正式的标准,成为增强型802.11b.802.11b+与802.11b完全兼容,只是采用了Packet Binary Convolutional Coding(PBCC)数据调制技术,所以能够实现高达22Mbps的传输速率.
此外,一些公司还推出了同时兼容802.11b和802.11a的接入点产品和网卡产品,提供双频接入,从而支持802.11a、802.11b或者同时支持两种方式,使得网络中所有无线用户既能同时实现与有线网络的连接,又能实现彼此之间的连接,有效解决了标准之间不兼容问题,保护了用户的投资.
#### IEEE802.16
IEEE802.16是宽带无线协议.802.16工作组成立与1999年,其主要使命是推动固定宽带无线接入系统的发展与应用.IEEE802.16工作组负责对无线本地环路的无线接口及其相关功能制定标准,它包括3个项目组,每个项目组负责不同的方面:802.16.1负责制定频率为10~60GHz的无线接口标准;802.16.2负责制定宽带无线接入系统共存方面的标准;802.16.3负责制定频率范围在2~10GHz之间并获得频率使用许可的无线接口的标准.2001年12月,IEEE批准通过了802.16标准,802.16也被成为"Wireless-MAN".
802.16协议标准是按照3层结构体系组织的:
1. 物理层.物理层协议主要是关于频率带宽、调制模式、纠错技术以及发射机同接收机之间的同步、数据传输率和时分复用结构等方面的.对于从用户到基站的通信,该标准使用的是"按需分配多路寻址"(DAMA-TDMA)技术.按需分配多路寻址(DAMA)技术是一种根据多个站点之间的容量需要的不同而动态分配信道容量的技术.时分多路技术可以根据每个站点的需要为其在每个帧中分配一定数量的时隙来组成每个站点的逻辑信道.通过DAMA-TDMA技术,每个信道的时隙分配可以动态地改变.
2. 数据链路层.在该层上IEEE802.16规定的主要是为用户提供服务所需的各种功能.这些功能都包括在介质方位控制MAC层中,主要负责将数据组成帧格式来传输和对用户如何接入到共享的无线介质中进行控制.MAC协议规定基站或用户在什么时候采用何种方式来初始化信道,并分配无线信道容量.位于多个TDMA帧中的一系列时隙为用户组成一个逻辑上的信道,而MAC帧则通过这个逻辑信道来传输.IEEE802.16规定每个单独信道的数据传输率范围是从2Mbit/s到155Mbit/s.
3. 会聚层.在MAC层之上是会聚层,该层根据提供服务的不同而提供不同的功能.对于IEEE802.16.1来说,能提供的服务包括数字音频/视频广播、数字电话、异步传输模式ATM、因特网接入、电话网络中无线中继和帧中继.
### 蓝牙技术
具体说来,蓝牙是一种短距离的无线连接技术标准的代称,蓝牙的实质内容就是要建立通用的无线电空中接口及其控制软件的公开标准.
蓝牙计划主要面向网络中各类数据及语音设备,使用无线微波的方式将它们连接成一个微微网,多个微微网之间也可以互连,从而方便快速的实现各类设备之间的通信.
蓝牙采用分散式网络结构以及快跳频和短包技术,支持点对点及点对多点通信,工作在全球通用的2.4GHz ISM频段.其数据频率为1Mbps,采用时分双工传输方案实现全双工传输.
蓝牙1.0标准有两个文件组成.一个是核心部分,它规定的是设计标准;另一个叫协议子集部分,它规定的是运作性准则.
蓝牙协议可以分为4层,及核心协议层、电缆替代协议层、电话控制协议层和采纳的其它协议层.
蓝牙的核心协议包括基带、链路管理、逻辑链路控制与适应协议四部分.
链路管理(LMP)负责蓝牙组件间连接的简历.通过连接的发起、交换、核实,进行身份鉴权和加密等安全方面的任务;通过协商确定基带数据分组大小;它还控制无线单元的电源模式和工作周期,以及微波网内蓝牙组件的连接状态.
逻辑链路控制与适应协议(L2CAP)位于基带协议层智商,属于数据链路层,是一种为高层传输和应用层协议屏蔽基带协议的适配协议,其完成数据的拆装、基带与高协议间的适配,并通过协议复用、分组及重组操作为高层提供数据业务和分类提取,它允许高潮呢过协议和应用接收或发送长过64K字节的L2CAP数据包.
业务搜寻协议(SDP)是极其重要的部分,它是所使用模式的基础.通过SDP,可以查询设备信息
、业务及业务特征,并在查询之后建立两个或多个蓝牙设备间的连接.SDP支持3种查询方式;按业务类别搜寻、按业务属性搜寻和业务浏览.
蓝牙作为一个全球公开的无线应用标准,通过把各种语音和数据设备用无线链路连接起来,使人们能随时随地进行数据信息的交换与传输.无疑,它将在人们的日常生活和工作中扮演重要的角色,其市场潜力巨大,正成为21世纪的投资热点.
### IrDA
红外线数据标准协会成立于1993年.IrDA数据传输技术是一种利用红外线进行点对点通信的技术.
基于红外线的传输技术最近几年有了很大发展.目前广泛使用的家电遥控器几乎都是采用的红外线传输技术.作为无线局域网的传输方式,红外线方式的最大优点是不受无线电干扰、且它的使用不受国家无线管理委员会的限制.但是,红外线对非透明物理的透过性较差,导致传输距离受限制.
红外线是波长在750nm~2mm之间的电磁波,它的频率高于微波而低于可见光,是一种人的眼睛看不见的光线.红外通信一般采用红外波段内的红外线,波长在0.75$\mu$m~25$\mu$m之间.红外数据协会(IrDA)成立后,为了保证不同厂商的红外产品能够获得最佳的通信效果,红外通信协议将红外数据通信所采用的光波波长的范围限定在850nm~900nm之内.
IrDA标准包括三个基本的规范和协议:物理层规范、连接建立协议和链接管理协议,物理层规范制定了红外通信硬件设计上的目标和要求,IrLAP和IrLMP为两个软件层,负责对链接进行设置、管理和维护.在IrLAP和IrLMP基础上,针对一些特定的红外通信应用领域、IRDA还陆续发布了一些更高级别的红外协议.
### HomeRF
HomeRF是由HomeRF工作组开发的,适合家庭区域范围内在PC和用户电子设备之间实现无线数字通信的开发性工业标准.
HomeRF工作在2.4GHz频段,采用数字跳频扩频技术,速率为50跳/秒,并由75个带宽为1MHz跳频信道.调制方式为2FSK与4FSK.数据的传输速率在2FSK方式下为1Mbit/s,在4FSK方式下为2Mbit/s.在新版HomeRF2.x中采用了带宽频率群技术把跳频带宽增加到了3MHz和5MHz,跳频速率也加到75跳/秒,数据传输速率达到了10Mbit/s.
HomeRF工作组制定了共享无线访问协议(SWAP)无线通信规范,定义了一个新的通用空中接口,此接口支持家庭范围内语音、数据的无线通信.用户使用符合SWAP规范的电子产品可实现在PC的外设、无线电话等设备之间建立一个无线网络,以共享语音和数据;在家庭区域范围内的任何地方,可以利用便携式微型显示设备浏览因特网;在PC和其它外设之间共享一个ISP连接等多项共享功能.
### 无线应用协议WAP
1997年包括摩托罗拉、诺基亚、爱立信和美国的软件公司的一些跨国通信技术公司共同制定了新一代无线应用协议(WAP).WAP是一种使用在无线通信设备上的新的移动通信技术,其功能类似于因特网上的HTTP协议.它定义了一系列将因特网内容过滤和转化为适用移动通信的标准,使内容可以更容易地在移动终端上显示,使得利用手机就可以介入因特网并使用因特网上的各种应用.
WAP定义了一个开放的标准化的结构以及一系列的标准以实现因特网的无线介入访问,WAP主要包括3部分:客户、网关和WWW服务器.其中WWW服务器就是目前常用的WWW服务器.网关与服务器之间通过HTTP协议进行通信,这就意味着服务的提供者几乎可以不改动信息的内容,只要增加网关设备,就可以向移动用户提供信息.
#### 无线标记语言(WML)
WAP移动终端上的浏览器所识别的描述语言不再是HTML或JavaScript,而是无线标记语言(WML)和无线标记语言脚本WMLScript.WML是一种符合XML标准的描述语言,在WML中使用的标记数量比HTML使用的要少很多,这主要是为了易于在终端设备中实现.这些移动设备的存储设备容量不大,不可能防止很大的系统和复杂的应用程序.HTML文档是平面性的,而WML的文档由一系列精心定义的用户交互单元组成,一个交互单元成为一个卡,用户可以在一个或多个WML文档的Card之间进行浏览.
#### WDP协议
众所zhouzhi,HTTP所采用的是TCP/IP协议,而WAP所采用的通信协议则是无线数据报协议(WDP).WDP是属于无线网络传输层的协议,其作用是为了使WAP能使用TCP/IP访问因特网.
#### WAP网关
WAP网关用标准的HTTP1.1协议从WWW服务器上获取信息,然后将其转换为WML格式的文档,并提供给移动终端.这样只需要增加网关设备就可以将现有的WWW服务器上的内容发给移动用户,而不需要专门开发相关的信息内容.WAP规范使用标准的Web代理技术来将无线网络与Web连接起来.通过将处理功能几种在WAP网关中,WAP结构大大减少了手机上的操作负载.此外,网关还要完成DNS的功能.这样,终端只需要输入URL就可以得到相应的信息,减少了终端设备上浏览器的负担,使之既简单又廉价.网关的另一个功能是尽可能地减少用户浏览网络的时延,它可以通过与其他信息服务器之间的高速连接,减少信息获取的时间.
#### 轻量级协议栈
WAP协议栈将无线手机访问因特网的带宽需求降到最低,保证了各种无线网络都可以使用WAP规范.通过使用WAP协议栈可以节省大量的无线带宽.要完成同样一个访问操作,使用WAP协议栈涉及的包数量不到使用全标准HTTP/TCP/IP协议栈的一半,这对于带宽严重受阻的无线网络来讲五一是十分有益的.
## 移动Ad Hoc网络
Ad Hoc网络又称移动自组网、多跳网络,是一种特殊的在不借助中心管理的情况下,在有限的范围内实现多个移动终端的临时互连,它为局域网内的移动通信网络提供了一种灵活的互连方式.
### 移动Ad Hoc网络的特点和应用
#### 移动Ad Hoc网络的特点
由于移动Ad Hoc网络是一种移动、多跳、自律的系统,它是移动通信和计算机网络相结合的网络,网络中的每个节点都兼有路由器和主机两种功能.移动Ad Hoc网络的特点主要体现在一下四方面:
1. 网络的独立性.Ad Hoc网络想对常规通信网络而言,最大的区别就是可以在任何时刻、任何地点不需要硬件基础设施的支持,快速构建起一个移动通信网络.它的建立不依赖于现有网络通信设施,具有一定的独立性.
2. 动态变化的网络拓扑结构.在Ad Hoc网络中,移动主机可以在网中随意移动.主机的移动会导致主机之间的链路增加或消失,主机之间的关系不断发生变化.另外,主机可能同时还是路由器,因此,移动会使网络拓扑结构不断发生变化,而且变化的方式和速度都是不可预测的.加上无线发射装置发送功率的变化、环境的影响以及信号之间的互相感染等因素,都会造成网络拓扑结构的动态变化.对于常规网络而言,网络拓扑结构则相对较为稳定.
3. 有限的无线通信带宽.在Ad Hoc网络中没有有线基础设施的支持,因此,主机只见到额通信均通过无线传输来完成.由于无线信道本身的物理特性,它提供的网络带宽相对有线信道要低得多.除此以外,考虑到竞争共享无线信道产生的碰撞、信号衰减、噪音干扰等多种因素,移动终端可得到的实际带宽远远小于理论中的最大带宽值.
4. 有限的主机能源.在Ad Hoc网络中,主机均是一些移动设备.由于主机可能出在不停的移动状态下,主机的能源主要有电池提供,因此Ad Hoc网络又能源有限的特点,在进行系统设计是节能就成为一个非常重要的指标.
5. 网络的分布式特性.在Ad Hoc网络中没有中心控制节点,主机通过分布式协议互连.一旦网络的某个或某些节点发生故障,其余的节点仍然能够正常工作.
6. 生存周期短.Ad Hoc网络主要用于临时的通信需求,相对于有线网络,它的生存时间一般比较短.
7. 有限的物理安全.
#### 移动Ad Hoc网络的应用需求
1. 没有有线通信设施的地方
2. 需要分布式特性的网络通信环境
3. 现有有线通信设施不足,需要临时快速建立一个通信网络的环境
4. 作为生存性较强的后备网络

### 移动Ad Hoc网络的结构和路由协议
#### Ad Hoc网络的结构
Ad Hoc无线网络的拓扑结构可分为两种:对等是平面结构和分级结构.在对等式平面结构中,所有网络节点地位平等.
而在分级结构的Ad Hoc无线网络拓扑结构中,整个网络是以簇为子网组成,每个簇由一个簇头和多个簇成员组成,簇头形成高一级网络,高一级网络又可分簇形成更高一级网络.每一个簇中的cutout和簇成员是动态变化、自动组网.分级结构根据硬件的不同配置,有可以分为单频分级结构和多频分级结构.单频分级结构实用单一频率通信,所有节点使用统一频率;而在多频分级结构中,若存在两级网络,则低级网络通信范围小,高级网络通信范围大,簇成员用同一个频率通信,簇头节点用一个频率域簇成员通信,用另一个频率来维持于簇头之间的通信.
对等式平面结构和分级结构使用时各存在优缺点:对等式平面结构网络结构简单,各节点地位平等,源节点与目的节点通信时存在多条路径,不存在网络"瓶颈",而且网络想对比较安全,但最大的缺点是网络规模受到限制,当网络规模扩大时路由维护的开销指数增长而消耗掉有效的带宽;分级结构网络规模不受限制,可扩充性好,而且由于分簇,路由开销相对小一些,虽然分级结构中需要复杂的簇头选择算法,但由于分级网络结构具有较高的系统吞吐量,节点定位简单,目前Ad Hoc网络正逐渐呈现分级化的趋势,许多网络路由算法都是基于分级结构网络模式提出的.
### 移动Ad Hoc网络与其他移动通信系统的比较
#### Ad Hoc网络的路由协议
Ad Hoc网络设计中的一个关键问题是开发能够在两个节点之间提供高质量、高效率通信的路由协议.网络节点的移动性使得网络拓扑结构不断变化,传统的基于因特网的路由协议无法适应这些特性,因此,应用与Ad Hoc网络的路由协议必须满足以下的条件:
1. 必须对网络拓扑结构动态变化具有快速应变的能力,并且尽量避免路由环路的发生,提供方便简单的网络节点定位法.
2. 必须高效的利用有限的带宽资源,尽可能压缩不必要的开销
3. 实施多跳通信的中间转接次数也应是有限的,一般不要超过3次
4. 必须尽可能减少发射时间和发射的数据量,节约有限的工作能源.
5. 在可能的情况下,使设计的路由协议具有安全性,降低遭受攻击的可能性
#### Ad Hoc网络的路由协议分析
根据Ad Hoc网络路由协议的特殊性,近年来提出了多种Ad Hoc网络路由协议.IETF的MANET工作小组目前正专注于Ad Hoc网络路由协议的研究,提出了许多协议草案,另外,专业研究人员也发表了大量关于Ad Hoc网络路由协议的相关文章,提出了许多关于Ad Hoc的网络路由协议.根据路由触发原理,目前的路由协议大致可以分为先验式路由协议,反应式路由协议和混合式路由协议3种
1. 先验式路由协议.先验式路由协议又称表驱动路由协议,每个节点维护一张包含到达节点的路由信息的路由表,并根据网络拓扑的变化随时更新路由表,所以路由表可以准确的反映网络的拓扑结构;源节点一旦要发送报文,可以立即获得到达目的节点的路由,这类的路由协议通常是通过修改现有的有线路由协议来适应Ad Hoc无线路由要求.因此,这种路由协议的时延较小,但是协议需要大量的路由控制报文路由,协议的开销较大.
DSDV协议通过给每个路由设定序列号避免了路由环路的产生,采用时间驱动和事件驱动技术控制路由表的传送,即每个移动节点在本地都保留一张路由表,其中包括所有有效信宿点,路由跳数,信宿路由序列号等信息,信宿路由序列号用于区别新旧路由以避免环路的产生,每个节点周期性的将本地路由表传送给相邻节点,或者档期路由表发生变化时,也会将其路由信息传给临近点,当无节点移动时使用间隔较大的大数据包进行路由更新;临近节点收到包含修改的路由表信息后,先比较信源K信宿路由序列号的大小,信宿路由序列号大的路由将被采用,而信宿路由序列号小的路由则被淘汰,若相同,则采用最佳制式的路由.
HSR是一种用于分级网络的路由协议,高级节点保存它所有子孙节点的位置信息,沿从最高级的根节点到最低级的叶节点的路径为节点分配逻辑序列地址,可以用序列地址进行节点寻址.
CSR称为全局状态路由协议,其工作原理与DSDV协议类似,采用链路状态路由算法,但避免了路由报文的泛滥,它包括一个临近节点表、网络拓扑表、下一跳路由表和距离表.
无线路由协议WRP是一种距离-矢量路由协议,每个节点都维持一个距离表、路由表、链路开销表和报文重传表,通过其临近节点的最短路径生成数SST生成自己的SST后,再向邻节点传递更新信息.当网络路由表没有任何变化时,接收节点需回传一个空闲报文以示连接,否则,修改距离表,寻找更优路径.这种算法的特点是当检测到任意相邻节点变化时,则检查所有相邻节点的坚固性以消除回路,具有较快的收敛性.
2. 反应式路由协议.反应式路由协议又称随选路由或者按需路由,是一种当需要时才查找路由的路由选择方式.节点不需要维护及时准确的路由信息,当需要发送数据时才发起路由查找过程.与先验式路由协议相比,反应式路由协议的开销小,但是数据报传送时才发起路由查找过程.与先验式路由协议相比,反应式路由协议的开销小,但是数据报传送时延较大,不适合于实时性的应用.
AODVR协议:源节点发送数据前先广播一个路由请求消息,附近节点收到后再次广播,知道请求消息到达目的节点或到达知道目的节点的中间节点,目的节点或中间节点沿原来路径返回响应消息,源节点收到响应消息后就知道到达目的节点的路由.
DSR协议称为动态源路由协议,是一种源路由协议,每个分组的分组头中包含了源-目的整条路由信息.它采用路由缓存技术,用于存储源路由信息,当学习到新的路由时则修改路由缓存内容,该协议包含两个方面:路由发现和路由维护
TORA协议成为临时预定路由算法,是一种源初始化按需路由选择协议,它采用链路反转的分布式算法,具有高度自适应、高效率和较好的扩充性,比较适合高度动态移动、多跳的无线网络,其主要特点是控制报文定位在最靠近拓扑变化的一小部分节点处,因此节点只保留临近点的路由信息.该算法中路由不一定是最优的,常常使用次优路由以减少发现路由的开销.TORA协议包括3个基本模块:路由的创建、路由的维护和路由的删除
3. 混合式路由协议.Ad Hoc网络中单纯采用先验式或反应式路由协议都不能完全解决路由问题,因此,许多学者提出了结合先验式和反应式路由协议有点的混合式路由协议,如ZRP协议.ZRP协议是一个先验式和反应式路由协议的组合,网络内的所有节点都有一个以自己为中心的虚拟区,区内的节点数与设定的区半径有关,因此区是重叠的,这是与分群路由的区别;在区内使用先验式路由算法,中心节点使用区内路由协议IARP维持一个到区内其他成员的路由表,对区外的节点的路由使用按需路由,利用区间路由协议IERP建立临时的路由.但是,实施混合路由也面临着很多困难,如簇的选择和维护、先验式和反应式路由协议的合理选择以及网络工作的大流量等问题.
#### 与其它移动通信系统的比较
蜂窝系统、集群系统、卫星系统等传统的移动通信系统都需要有线网络通信基础设施的支持.这些设施的简历和运转需要大量的人力和物理,因此成本比较高,同时建设的周期也长.Ad Hoc网络不需要基站的支持,由主机自己组网,因此,网络建立的成本低,同时时间短,一般只要几秒钟或几分钟.上述通信系统中,移动终端之间并不直接通信,并且移动终端只具备收发功能,不具备转发功能.而Ad Hoc网络由移动主机构成,移动主机之间可以直接通信,而移动主机不仅收发数据,同时还转发数据.此外目前的移动通信系统主要为用户提供语音通信功能,通常采用电路交换,拓扑结构比较稳定.而Ad Hoc网络使用分组转发技术,主要为用户提供数据通信服务,拓扑结构易于变化.
Ad Hoc网络组网灵活、快捷,不受有线网络影响,可广泛应用于军事通信、发生地震或水灾后的营救等无法或不便预先敷设网络设施的场合,具有广阔的发展前景.
## 局域网操作系统
### 局域网操作系统的演变过程
局域网操作系统的定义是:在局域网低层所提供的数据传输能力的基础上,为高层网络用户提供共享资源管理和其他网络服务功能的局域网系统软件.
操作系统是计算机系统中的重要组成部分,它是计算机与用户之间的接口.单机操作系统必须具备以下两个基本功能:
1. 为用户提供各种简便有效的访问本机资源的手段
2. 合理地组织系统工作流程,有效的管理系统.
为实现上述功能,需要在操作系统中建立各种进程,编制不同的功能模块,按层次结构将功能模块有机的组织起来,以完成处理器管理、存储系统管理、文件系统管理、设备管理和作业控制等功能.
单机操作系统只能为本地用户使用本机资源提供服务,不能满足开放网络环境的要求.对于联网的计算机系统,它们不仅要为本地用户使用本地资源和网络资源提供服务,也要为远地网络用户使用资源提供服务.局域网操作系统的基本任务就是为用户提供各种基本网络服务功能,完成网络共享系统资源的管理,并提供网络系统的安全性服务.
局域网操作系统可以分为两类:面向任务型局域网操作系统和通用型局域网操作系统.面向任务型局域网操作系统时为某一种特殊网络应用要求而设计的;通用性局域网操作系统能提供基本的网络服务功能,以支持各个领域应用的需求.
通用性局域网操作系统又可以分为变形系统和基础级系统两类.变形系统是以原单机操作系统为基础,通过增加网络服务功能构成的局域网操作系统;基础级系统则是以计算机裸机的硬件为基础,根据网络服务的特殊要求,直接利用计算机硬件和软件资源进行设计的局域网操作系统.
局域网操作系统经历了从对等结构向非对等结构演变的过程:
1. 对等结构局域网操作系统.对等结构的局域网操作系统具有以下特点:联网节点地位平等、每个网络节点上安装的局域网操作系统软件均相同、联网计算机的资源原则上均相互共享.各联网计算机均以前后台方式工作,前台为本地用户提供服务,后台为其他节点的网络用户提供服务.对等结构的局域网操作系统可以提供共享硬盘、共享打印机、共享CPU、共享屏幕、电子邮件等服务.
对等结构局域网操作系统的优点是:结构简单,网络中任意两个节点间均可直接通信;其缺点是:每台联网的计算机既是服务器又是工作站,节点要承担较重的通信管理、网络资源管理和网络服务管理等工作.对于早期资源较少、处理能力有限的微机来说,要同时承担多项管理任务,势必降低性能指标.因此,对等结构局域网操作系统支持的网络系统一般规模均较小
2. 非对等结构局域网操作系统.非对等结构局域网操作系统的设计思想是将节点计算机分为网络服务器(Server)和网络工作站(Work Station,WS)两类.网络服务器采用高配置、高性能计算机,以集中方式管理局域网的共享资源,为网络工作站提供服务,网络工作站一般为配置较低的PC机,用以为本地用户访问本地资源和网络资源提供服务
非对等结构局域网操作系统的软件也分为两部分:一部分运行在服务器上;另一部分运行在工作站上.安装运行在服务器上的软件,是局域网操作系统的核心部分,其性能直接决定网络服务功能的强弱
早起的非对等结构局域网操作系统以共享硬盘服务器为基础,向网络工作站用户提供共享硬盘、共享打印机、电子邮件、通信等基本服务功能.这种系统效率低、安全性差,使用也不方便.为了克服这些缺点,提出了基于文件服务器的局域网操作系统的设计思想.
基于文件服务器的局域网操作系统软件由文件服务器软件和工作站软件两部分组成,文件服务器具有分时系统文件管理的全部功能,向网络用户提供完善的数据,文件和目录服务.
初期开发的基于文件服务器的局域网操作系统属于变形级系统,其典型事例是3+网操作系统.在变形级系统中,作为文件服务器的计算机安装了基于DOS的文件服务器软件.由于对硬盘的额存取控制仍通过DOS的BIOS进行,因此在服务器大量读/写操作时会造成网络性能的下降.
后期开发的局域网操作系统君属于基础级系统,它们具有优越的网络性能,能提供很强的网络服务功能,目前大多数局域网操作系统都采用这种方式.
#### 局域网操作系统的基本服务功能
1. 文件服务.文件服务是局域网操作系统中最重要、最基本的网络服务功能.文件服务器以集中方式管理共享文件,为网络工作站提供完整的数据、文件、目录服务.用户可以根据所规定的权限对文件进行建立、打开、关闭、删除、读写等操作.
2. 打印服务.打印服务也是局域网操作系统提供的基本网络服务功能.共享打印服务可以通过设置专门的打印服务器来实现,打印服务器也可由文件服务器或工作站兼任.局域网中可以设置一台或多台共享打印机,向网络用户提供远程共享打印服务.打印服务实现对用户打印请求的接收、打印格式的说明、打印机的配置、打印队列的管理等功能.
3. 数据库服务.随着局域网应用的深入,用户对网络数据库服务的需求也日益增加.Clent/Server工作模式以数据库管理系统为后援,将数据库操作与应用程序分离开来,分别由服务器端数据库和客户端工作站来执行.用户可以使用结构化查询语言SQL向数据库服务器发出查询请求,由数据库服务器完成查询后再将结果传送给用户.Client/Server工作模式优化了局域网操作系统的协同操作性能,有效的增强了局域网操作系统的服务功能.
4. 通信服务.局域网操作系统提供的通信服务主要有工作站与工作站之间的对等通信、工作站与主机之间的通信服务等功能.
5. 信息服务.局域网可以存储-转发方式或对等的点-点通信方式向用户提供电子邮件服务,也可提供文本文件、二进制文件的传输服务以及图像、视频、语音等数据的同步传输服务
6. 分布式服务.局域网操作系统的分布式服务功能,将不同地理位置的互联局域网中的资源组织在一个全局性的、可复制的分布式数据库中,网络中的多个服务器均有该数据库的副本.用户在一个工作站上注册,便可与多个服务器连接.服务器资源的存放位置对于用户来说是透明的,用户可以通过简单的操作访问大型互联局域网中的所有资源.

网络安全对用户来说十分重要,它包括用户口令、目录权限、文件和目录属性以及对用户登录工作站点及时间的限制.网络为目录提供了多种权限设置,如读权、写权、打开权、创建权、删除权、授权权、列目权和修改权.目录除了有权限还有属性,目录的属性有正常、隐含、系统和专用4种.对文件也可以设置属性,它们是只可执行、只可读、可读写、允许共享、不可共享、不可共享但可读写、隐文件、索引、上次备份后又已修改、系统文件及允许跟踪等属性.
局域网的可靠性在很大程度上取决于对服务器硬件故障的检错和纠错能力.对文件服务器的共享硬盘一般都采取了较多的可靠性措施,具体有分为以下几个级别:
第一级是对硬盘目录和文件分配表(FAT)的保护.在应胖的不同区域保存双份的目录和文件分配表,如果一处损坏,系统会自动转向另一处,并在硬盘中另找一处安排副本.
第二级是对硬盘表面损坏是的数据保护.为了防止将数据写入磁盘的不可靠块,采用了热调整及写后读验证着两个互补技术进行数据保护.
第三级是采用磁盘镜像的方法实现对硬盘驱动器损坏的保护.所谓磁盘镜像,即在一个磁盘通道上有两个成对的磁盘驱动器,同一数据分别写在两台硬盘上,如果一台硬盘驱动器损坏,另一台硬盘能单独运行,不会造成数据的丢失和系统停止.
第四级是采用磁盘双工,对磁盘通道或硬盘驱动器损坏起到保护作用.磁盘双工是采用两个磁盘通道,每个磁盘通道接磁盘镜像对中的一个硬盘.
第五级是一个称为事务跟踪系统TTS的附加容错功能,用以防止当数据写到数据库时,因系统故障而造成的数据库损坏.TTS起作用时,将数据库变更的整个过程看做是单个事务,仅当所有文件正确更正之后,事务才算整个完成.如果在一个事务执行期间发生系统故障,TTS便放弃这一事务已做的所有修改,并返回到数据库的原始状态.
### 典型局域网操作系统简介
#### NetWare
Novell公司开发的Novell NetWare网络操作系统是一个可使PC机网络取代小型机系统的多任务网络操作系统,它开创了工作站/服务器的结构,在一个Novell网络中允许有多个文件服务器,每个服务器可适用于不同类型的网卡.NetWare具有十分灵活的拓扑结构,并可以和其他网络在同一网络下工作,Novell网还提供了不同种类的网间连接器.
Novell NetWare由文件服务器软件、工作站软件、网桥软件等组成.其中文件服务器软件和工作站软件是建网不可缺少的软件,安装时需根据硬件的配置生成.由于Novell NetWare是直接对微处理器变成的,因而它总是可以和最新的微处理器一起发展,并能充分利用微处理器的高性能,形成高效的网络操作系统.Novell NetWare操作系统有多种版本.
Novell NetWare是在局域网的基础上建立的网络操作系统,因此它不同于一般的网络协议所需的完整的协议和通信传输功能,它具有所有操作系统的职能,因而结构相当复杂,它是一个围绕核心调度的多用户共享的操作系统,它包括磁盘处理、打印机处理、控制台命令处理及网络通信处理等面向用户的处理程序和一个多用户分时核心调度程序.
从网络层次结构的第3~7层来看,NetWare与标准网络协议有较大差别.因为NetWare是一个基于服务器的网络操作系统,因而NetWare的侧重点在于基于服务器的网络文件系统以及网络管理功能.这与数据通信为主要目的的网络软件有很大区别.
Novell NetWare的主要特点:
1. Novell网络为用户使用提供完善的安全措施
2. 具有系统容错的可靠性措施
3. 开放性的网络软件开发环境.开放数据链路接口ODI是Novel NetWare的一项重要网络互连技术.它的实现方法是以NetWare作为开放式服务器,支持多种通信协议和多种设备驱动程序,以构成异构的计算机网络.ODI允许在NetWare工作站上不必增加网络接口卡,就可使用多种网络协议来扩展网络.

NetWare Streams流提供了操作系统和网络通信协议之间的通用接口,它允许在单个文件服务器上存放和使用多种网络协议
NetWare的有关网络功能的C语言应用函数库,为用户灵活使用网络资源提供了高级语言接口.用户可以在自己的应用环境中,使用NetWare的网络功能,建立自身的网络开发环境.NetWare开放系统结构给用户使用和扩充自己的网络功能提供了极大方便
#### UNIX
自20世纪70年达中期问世后,UNIX操作系统便赢得了计算机界的普遍认可,并得到了广泛传播和迅速发展.作为工业标准的UNIX操作系统被广泛应用于大型机、中型机、小型机、工作站及微型机中,尤其在工作站中几乎全部采用了UNIX操作系统.
目前,常用的UNIX版本有AT&T和SCO公司的Unix SVR3.2、Unix SVR4.0以及Univell的Unix SVR4.2等.新推出的各种UNIX版本都将网络功能放在了首位.在Unix SVE3.2版本时,TCP/IP协议已经以模块形式运行于UNIX中;自Unix SVR4.0开始,TCP/IP协议更成了UNIX的核心组成,从而构成了UNIX网络操作系统.
UNIX网络操作系统的主要特点有:
1. 良好的用户界面.UNIX是较早提供图形用户界面的操作系统
2. 统一的处理方法.文件、目录及设备采用统一的处理方法
3. 强大的核外程序功能.UNIX的内核程序短小精悍,可以常驻于内存中,其余可分两部分均作为核外系统程序.这部分核外程序内容丰富、功能强大,可供用户自由选择、灵活搭配
4. 良好的可移植性.由于目前的UNIX用C语言编写,所以非常便于移植.
5. 良好的网络环境.UNIX网络环境包括齐全的网络通信协议、方便的网络通信工具及灵活的网络编程接口.
6. 完善的安全机制.为普通用户和特权用户分别提供了完善的多级安全保密机制
7. 多任务、多用户操作性.同时支持多道程序运行和多个用户登录

#### Windows NT
Microsoft公司将其成熟的Windows3.1技术与LAN Manager局域网操作系统技术集成,于1993年成功发布了Windows NT3.1,随后又于1996年年底推出了注明的Windows NT4.0版本,从此打破了网络操作系统NetWare一统天下的局面.
Windows NT4.0是一个客户/服务器模式工作于网络环境中的操作系统,它包括Windows NT Server4.0和Windows NT Workstation4.0两个产品,前者是一个基于服务器的功能强大的网络操作系统,后者是一个高级个人计算机多任务桌面操作平台.
由于Windows NT Server4.0具有与广大用户所熟悉的Windows95/98/2000等相似的用户界面和操作方式,从而为用户的学习、理解、长我和运用提供了极大的便利,使其迅速成为普及的网络操作系统之一.
Windows NT Server4.0主要技术特点:
1. 内存与任务管理.为操作系统和应用程序分配独立的内存空间,以防两者之间发生冲突;采用线程及占先式管理多任务,使应用程序能更高效的运行.
2. 开放的体系结构.支持网络驱动接口标准和传输驱动接口标准,内置TCP/IP,Microsoft MW Link、Net BIOS的扩展用户接口Net BEUI和数据链路控制4种标准网络协议.
3. 内置管理.通过内部安全保密机制,使网络管理可以为每个文件设置不同的访问权限、规定用户对服务器的操作权限及用户审计
4. 集中式管理.利用域与域信任关系实现对大型网络的管理
5. 用户工作站管理.通过用户描述文件对工作站用户的优先级、网络连接、程序组及用户的注册进行管理